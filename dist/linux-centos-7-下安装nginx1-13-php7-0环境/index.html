<!DOCTYPE html><html lang=zh><head><meta charset=UTF-8><meta name=baidu-site-verification content=rqskM4bdtP><meta name=viewport content="device-width, initial-scale=1, maximum-scale=1,user-scalable=no"><title>linux centos 7 下安装nginx1.13+php7.0环境-CavinHuang-不懂写故事的猫-http://blog.zukmb.cn</title><meta name=keywords content=前端学习,php学习,个人博客,HTML,CSS,JS><meta name=description content=cavinHuang个人博客，这里记录学习和生活的点滴！><meta name=google-site-verification content=zOYxWUgmeogC0qY76WLP0eWl8r9E8jk_qU927Ij7tbs><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5a4c3745fa28006f"></script><link rel=stylesheet href=/css/yoyo.css><link rel=icon href=/img/favicon.png><link rel=stylesheet href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css?version=1.3"><script src=//cdn.bootcss.com/jquery/3.2.1/jquery.min.js></script><script src=//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js></script><script src=https://cdn.bootcss.com/velocity/1.5.0/velocity.min.js></script></head><body></body></html><div class=app><div class=left-container><canvas id=cas></canvas><div class="left-layout-container pc"><div class=user-info><a href="/"><img src="https://avatars1.githubusercontent.com/u/24950299?s=460&amp;v=4"></a><div class=login-name>CavinHuang</div><div class=slog>来不及总结自己,愿天大地大,我独一无二!</div></div><ul class=other-site><li><img src=http://www.17sucai.com/preview/177065/2017-09-28/Mon9/static/img/github.png></li><li><img src=http://www.17sucai.com/preview/177065/2017-09-28/Mon9/static/img/weibo.png></li></ul><ul class=left-menu><li><a href=/archives>文章</a></li><li><a href=/categories>分类</a></li><li><a href=/tags>标签</a></li><li><a href=/about>关于</a></li></ul><div class=qq-group><span>读万卷书</span><span>行万里路</span></div><div class=copyright>@ 2017 - 2017 CavinHuang</div></div></div><div class="blog-container main-container" id=content-outer><div class=blog-list-container id=content-inner><article class=article-container id=post><div class=article-header><h1 class=article-title>linux centos 7 下安装nginx1.13+php7.0环境</h1><div class=article-subtitle><div class="publish-time fl">发布时间:<span>2017/12/27 11:7:51</span></div><div class=categories>分类:<a href="/categories/服务器纪实/"><span>服务器纪实</span></a>/<a href="/categories/服务器纪实/nginx/"><span>nginx</span></a></div></div></div><div class=article-content><h1 id=Nginx1-13-安装><a href=#Nginx1-13-安装 class=headerlink title="Nginx1.13 安装"></a>Nginx1.13 安装</h1><h2 id=安装-nginx-需要的扩展gcc，pcre-devel，zlib-devel，-openssl-openssl-devel><a href=#安装-nginx-需要的扩展gcc，pcre-devel，zlib-devel，-openssl-openssl-devel class=headerlink title="安装 nginx 需要的扩展gcc，pcre-devel，zlib-devel， openssl openssl-devel"></a>安装 nginx 需要的扩展gcc，pcre-devel，zlib-devel， openssl openssl-devel</h2><figure class="highlight bash"><table><tr><td class=gutter><pre><div class=line>1</div></pre></td><td class=code><pre><div class=line>　yum -y install gcc-c++ pcre-devel zlib-devel openssl openssl-devel</div></pre></td></tr></table></figure><a id=more></a><h2 id=安装Nginx><a href=#安装Nginx class=headerlink title=安装Nginx></a>安装Nginx</h2><figure class="highlight bash"><table><tr><td class=gutter><pre><div class=line>1</div><div class=line>2</div><div class=line>3</div><div class=line>4</div><div class=line>5</div><div class=line>6</div><div class=line>7</div></pre></td><td class=code><pre><div class=line>　<span class=built_in>cd</span> /usr/<span class=built_in>local</span>/src;</div><div class=line>　wget http://nginx.org/download/nginx-1.13.8.tar.gz</div><div class=line>　tar -zxvf nginx-1.13.8.tar.gz -C /usr/<span class=built_in>local</span>/src</div><div class=line>　<span class=built_in>cd</span> /usr/<span class=built_in>local</span>/src/nginx-1.13.8</div><div class=line>　./configure    <span class=comment>#默认安装到/usr/local/nginx目录下</span></div><div class=line>　make    <span class=comment>#编译</span></div><div class=line>　make install    <span class=comment>#安装</span></div></pre></td></tr></table></figure><h2 id=启动Nginx><a href=#启动Nginx class=headerlink title=启动Nginx></a>启动Nginx</h2><figure class="highlight bash"><table><tr><td class=gutter><pre><div class=line>1</div></pre></td><td class=code><pre><div class=line>　/usr/<span class=built_in>local</span>/nginx/sbin/nginx   开启Nginx</div></pre></td></tr></table></figure><h2 id=Nginx设置开机自启><a href=#Nginx设置开机自启 class=headerlink title=Nginx设置开机自启></a>Nginx设置开机自启</h2><figure class="highlight bash"><table><tr><td class=gutter><pre><div class=line>1</div><div class=line>2</div></pre></td><td class=code><pre><div class=line>　vim /etc/rc.local中添加/usr/<span class=built_in>local</span>/nginx/sbin/nginx，保存并推出</div><div class=line>　chmod -R 777 /etc/rc.local</div></pre></td></tr></table></figure><h2 id=Nginx-配置文件所在目录><a href=#Nginx-配置文件所在目录 class=headerlink title="Nginx 配置文件所在目录"></a>Nginx 配置文件所在目录</h2><figure class="highlight bash"><table><tr><td class=gutter><pre><div class=line>1</div></pre></td><td class=code><pre><div class=line>　/usr/<span class=built_in>local</span>/nginx/conf</div></pre></td></tr></table></figure><h2 id=nginx编译扩展参考https-www-cnblogs-com-zhang-shijie-p-5294162-html><a href=#nginx编译扩展参考https-www-cnblogs-com-zhang-shijie-p-5294162-html class=headerlink title=nginx编译扩展参考https://www.cnblogs.com/zhang-shijie/p/5294162.html></a>nginx编译扩展参考<a href=https://www.cnblogs.com/zhang-shijie/p/5294162.html target=_blank rel=external>https://www.cnblogs.com/zhang-shijie/p/5294162.html</a></h2><h1 id=php7编译安装><a href=#php7编译安装 class=headerlink title=php7编译安装></a>php7编译安装</h1><figure class="highlight bash"><table><tr><td class=gutter><pre><div class=line>1</div><div class=line>2</div><div class=line>3</div><div class=line>4</div><div class=line>5</div><div class=line>6</div><div class=line>7</div><div class=line>8</div><div class=line>9</div><div class=line>10</div><div class=line>11</div><div class=line>12</div><div class=line>13</div><div class=line>14</div><div class=line>15</div><div class=line>16</div><div class=line>17</div></pre></td><td class=code><pre><div class=line>　　<span class=built_in>cd</span> /usr/<span class=built_in>local</span>/src/</div><div class=line>　　wget http://cn2.php.net/distributions/php-7.0.2.tar.gz</div><div class=line>　　tar -xzxvf php-7.0.2.tar.gz</div><div class=line>　　<span class=built_in>cd</span> php-7.0.2</div><div class=line>　　<span class=comment># 检查php所需要的全部扩展 ,没有的话执行</span></div><div class=line>　　yum -y install libxml2 libxml2-devel openssl openssl-devel curl-devel  libjpeg.x86_64 libpng.x86_64 freetype.x86_64 libjpeg-devel.x86_64 libpng-devel.x86_64 freetype-devel.x86_64 libjpeg-devel bzip2-devel.x86_64 libXpm-devel install gmp-devel icu libicu libicu-devel  php-mcrypt  libmcrypt  libmcrypt-devel  postgresql-devel libxslt-devel</div><div class=line>　　<span class=comment># 注：因为改为用nginx了，所以编译参数中的--with-apxs2=/usr/bin/apxs去掉了，如果要配置apache用，安装PHP前，请先安装apache。</span></div><div class=line> 　　<span class=comment>#编译参数配置</span></div><div class=line>　　./configure --prefix=/usr/<span class=built_in>local</span>/php --with-pdo-pgsql --with-zlib-dir --with-freetype-dir --<span class=built_in>enable</span>-mbstring --with-libxml-dir=/usr --<span class=built_in>enable</span>-soap --<span class=built_in>enable</span>-calendar --with-curl --with-mcrypt --with-gd --with-pgsql --<span class=built_in>disable</span>-rpath --<span class=built_in>enable</span>-inline-optimization --with-bz2 --with-zlib --<span class=built_in>enable</span>-sockets --<span class=built_in>enable</span>-sysvsem --<span class=built_in>enable</span>-sysvshm --<span class=built_in>enable</span>-pcntl --<span class=built_in>enable</span>-mbregex --<span class=built_in>enable</span>-exif --<span class=built_in>enable</span>-bcmath --with-mhash --<span class=built_in>enable</span>-zip --with-pcre-regex --with-pdo-mysql --with-mysqli --with-jpeg-dir=/usr --with-png-dir=/usr --<span class=built_in>enable</span>-gd-native-ttf --with-openssl --with-fpm-user=www-data --with-fpm-group=www-data --with-libdir=/lib/x86_64-linux-gnu/ --<span class=built_in>enable</span>-ftp --with-gettext --with-xmlrpc --with-xsl --<span class=built_in>enable</span>-opcache --<span class=built_in>enable</span>-fpm --with-iconv --with-xpm-dir=/usr</div><div class=line>``` 　　</div><div class=line>&gt; configure: error: mcrypt.h not found. Please reinstall libmcrypt. 报错这个的时候参考 http://blog.csdn.net/l_yangliu/article/details/53018117</div><div class=line>　　　　</div><div class=line>　　配置的checking 结束后，执行：    make clean &amp;&amp; make &amp;&amp; make install（如果出现错误：--ENABLE-OPCACHE=NO时执行<span class=built_in>export</span> LD_LIBRARY_PATH=/usr/<span class=built_in>local</span>/mysql/lib或<span class=built_in>export</span> LD_LIBRARY_PATH=/lib/:/usr/lib/:/usr/<span class=built_in>local</span>/lib）</div><div class=line></div><div class=line>　　装完成后，我们要把源码包中的配置文件复制到PHP安装目录下，源码包中有两个配置  php.ini-development  php.ini-production  ，看名字就知道，一个是开发环境，一个是生产环境，我们这里就复制开发环境的</div><div class=line>```bash</div><div class=line>  cp php.ini-development /usr/<span class=built_in>local</span>/php/lib/php.ini</div></pre></td></tr></table></figure><p>另外还需要设置环境变量 ：修改vim /etc/profile文件使其永久性生效，并对所有系统用户生效，在文件末尾加上如下两行代码<br><figure class="highlight bash"><table><tr><td class=gutter><pre><div class=line>1</div><div class=line>2</div></pre></td><td class=code><pre><div class=line>　PATH=<span class=variable>$PATH</span>:/usr/<span class=built_in>local</span>/php/bin</div><div class=line>　<span class=built_in>export</span> PATH</div></pre></td></tr></table></figure></p><p>然后执行 命令 source /etc/profile</p><p>php -v 就可以看到PHP版本信息了。</p><p>此时还需要配置PHP-fpm:<br><figure class="highlight bash"><table><tr><td class=gutter><pre><div class=line>1</div><div class=line>2</div><div class=line>3</div><div class=line>4</div></pre></td><td class=code><pre><div class=line>　cp /usr/<span class=built_in>local</span>/php/etc/php-fpm.conf.default /usr/<span class=built_in>local</span>/php/etc/php-fpm.conf</div><div class=line>　cp /usr/<span class=built_in>local</span>/php/etc/php-fpm.d/www.conf.default /usr/<span class=built_in>local</span>/php/etc/php-fpm.d/www.conf</div><div class=line>　cp /usr/<span class=built_in>local</span>/src/php-7.0.2/sapi/fpm/init.d.php-fpm /etc/init.d/php-fpm</div><div class=line>　chmod +x /etc/init.d/php-fpm</div></pre></td></tr></table></figure></p><p>启动php-fpm:<br><figure class="highlight bash"><table><tr><td class=gutter><pre><div class=line>1</div><div class=line>2</div></pre></td><td class=code><pre><div class=line>useradd www-data;     </div><div class=line>/usr/<span class=built_in>local</span>/php/sbin/php-fpm</div></pre></td></tr></table></figure></p><p>php-fpm设置开机自启<br><figure class="highlight bash"><table><tr><td class=gutter><pre><div class=line>1</div></pre></td><td class=code><pre><div class=line>systemctl <span class=built_in>enable</span> php-fpm</div></pre></td></tr></table></figure></p></div><div id=side-right-bar><div class=close-right-bar></div><div class=sidebar-toc><div class=sidebar-toc__title>目录</div><div class=sidebar-toc__progress><span class=progress-notice>你已经阅读了</span><span class=progress-num>0</span><span class=progress-percentage>%</span><div class=sidebar-toc__progress-bar></div></div><div class=sidebar-toc__content><ol class=toc><li class="toc-item toc-level-1"><a class=toc-link href=#Nginx1-13-安装><span class=toc-number>1.</span> <span class=toc-text>Nginx1.13 安装</span></a><ol class=toc-child><li class="toc-item toc-level-2"><a class=toc-link href=#安装-nginx-需要的扩展gcc，pcre-devel，zlib-devel，-openssl-openssl-devel><span class=toc-number>1.1.</span> <span class=toc-text>安装 nginx 需要的扩展gcc，pcre-devel，zlib-devel， openssl openssl-devel</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#安装Nginx><span class=toc-number>1.2.</span> <span class=toc-text>安装Nginx</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#启动Nginx><span class=toc-number>1.3.</span> <span class=toc-text>启动Nginx</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#Nginx设置开机自启><span class=toc-number>1.4.</span> <span class=toc-text>Nginx设置开机自启</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#Nginx-配置文件所在目录><span class=toc-number>1.5.</span> <span class=toc-text>Nginx 配置文件所在目录</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#nginx编译扩展参考https-www-cnblogs-com-zhang-shijie-p-5294162-html><span class=toc-number>1.6.</span> <span class=toc-text>nginx编译扩展参考https://www.cnblogs.com/zhang-shijie/p/5294162.html</span></a></li></ol></li><li class="toc-item toc-level-1"><a class=toc-link href=#php7编译安装><span class=toc-number>2.</span> <span class=toc-text>php7编译安装</span></a></li></ol></div></div></div><div class=right-btn id=right-btn><span>目录</span></div><div class=article-bottom><div class="addthis_inline_share_toolbox fr"></div></div><div class=post-copyright><div class=post-copyright__author><span class=post-copyright-meta>文章作者:</span><span class=post-copyright-info><a href=mailto:undefined>CavinHuang</a></span></div><div class=post-copyright__type><span class=post-copyright-meta>文章链接:</span><span class=post-copyright-info><a href="http://blog.zukmb.cnlinux-centos-7-下安装nginx1-13-php7-0环境/">http://blog.zukmb.cnlinux-centos-7-下安装nginx1-13-php7-0环境/</a></span></div><div class=post-copyright__notice><span class=post-copyright-meta>版权声明:</span><span class=post-copyright-info>转载请注明来自<a href=http://blog.zukmb.cn target=_blank style="font-size: 18px;">CavinHuangのBlog</a>！</span></div></div><div class=article-pagenate><div class="article-prev fl"><span>←</span><a href="/mysql创建远程用户并授权/">mysql创建远程用户并授权</a></div><div class="article-next fr"><a href="/linux-composer-安装/">linux composer 安装</a><span>→</span></div></div></article></div><footer class=footer><div id=toTop style="display: none;">Back to Top</div></footer></div></div><canvas class=fireworks></canvas><script src=/js/velocity.ui.min.js></script><script src=/js/yoyo.js></script><script src=/js/scroll.js></script><script src=/js/particle.js></script><script src=/js/anime.min.js></script><script src=/js/fireworks.js></script>