<!DOCTYPE html><html lang=zh><head><meta charset=UTF-8><meta name=baidu-site-verification content=rqskM4bdtP><meta name=viewport content="device-width, initial-scale=1, maximum-scale=1,user-scalable=no"><title>H5手机端开发问题汇总及解决方案-CavinHuang-不懂写故事的猫-http://blog.zukmb.cn</title><meta name=keywords content=前端学习,php学习,个人博客,HTML,CSS,JS><meta name=description content=cavinHuang个人博客，这里记录学习和生活的点滴！><meta name=google-site-verification content=zOYxWUgmeogC0qY76WLP0eWl8r9E8jk_qU927Ij7tbs><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5a4c3745fa28006f"></script><link rel=stylesheet href=/css/yoyo.css><link rel=icon href=/img/favicon.png><link rel=stylesheet href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css?version=1.3"><script src=//cdn.bootcss.com/jquery/3.2.1/jquery.min.js></script><script src=//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js></script><script src=https://cdn.bootcss.com/velocity/1.5.0/velocity.min.js></script></head><body></body></html><div class=app><div class=left-container><canvas id=cas></canvas><div class="left-layout-container pc"><div class=user-info><a href="/"><img src="https://avatars1.githubusercontent.com/u/24950299?s=460&amp;v=4"></a><div class=login-name>CavinHuang</div><div class=slog>来不及总结自己,愿天大地大,我独一无二!</div></div><ul class=other-site><li><img src=http://www.17sucai.com/preview/177065/2017-09-28/Mon9/static/img/github.png></li><li><img src=http://www.17sucai.com/preview/177065/2017-09-28/Mon9/static/img/weibo.png></li></ul><ul class=left-menu><li><a href=/archives>文章</a></li><li><a href=/categories>分类</a></li><li><a href=/tags>标签</a></li><li><a href=/about>关于</a></li></ul><div class=qq-group><span>读万卷书</span><span>行万里路</span></div><div class=copyright>@ 2017 - 2017 CavinHuang</div></div></div><div class="blog-container main-container" id=content-outer><div class=blog-list-container id=content-inner><article class=article-container id=post><div class=article-header><h1 class=article-title>H5手机端开发问题汇总及解决方案</h1><div class=article-subtitle><div class="publish-time fl">发布时间:<span>2018/3/30 20:33:59</span></div><div class=categories>分类:<a href="/categories/web前端开发/"><span>web前端开发</span></a></div></div></div><div class=article-content><h2 id=踏坑第一式><a href=#踏坑第一式 class=headerlink title=踏坑第一式></a>踏坑第一式</h2><ul><li>ios竖屏拍照上传，图片被旋转问题</li></ul><p>解决方案<br><figure class="highlight js"><table><tr><td class=gutter><pre><div class=line>1</div><div class=line>2</div><div class=line>3</div><div class=line>4</div><div class=line>5</div><div class=line>6</div><div class=line>7</div><div class=line>8</div></pre></td><td class=code><pre><div class=line><span class=comment>// 几个步骤</span></div><div class=line><span class=comment>// 1.通过第三方插件exif-js获取到图片的方向</span></div><div class=line><span class=comment>// 2.new一个FileReader对象，加载读取上传的图片</span></div><div class=line><span class=comment>// 3.在fileReader的onload函数中，得到的图片文件用一个Image对象接收</span></div><div class=line><span class=comment>// 4.在image的onload函数中，利用步骤1中获取到的方向orientation，通过canvas旋转校正，重新绘制一张新图</span></div><div class=line><span class=comment>// 注意iPhone有3个拍照方向需要处理，横屏拍摄，home键在左侧，竖屏拍摄，home建上下</span></div><div class=line><span class=comment>// 5.将绘制的新图转成Blob对象，添加到FormData对象中，然后进行校正后的上传操作</span></div><div class=line><span class=comment>// 代码有点杂，待整理后上传，网上应该是可以找到的</span></div></pre></td></tr></table></figure></p><a id=more></a><h2 id=踏坑第二式><a href=#踏坑第二式 class=headerlink title=踏坑第二式></a>踏坑第二式</h2><p>ios：DOM元素固定一边，另一边滚动，滚动很卡的问题<br><figure class="highlight html"><table><tr><td class=gutter><pre><div class=line>1</div><div class=line>2</div></pre></td><td class=code><pre><div class=line>// (横向滚动用的多些)简单粗暴的办法，样式添加如下属性</div><div class=line>-webkit-overflow-scrolling: touch;</div></pre></td></tr></table></figure></p><h2 id=踏坑第三式><a href=#踏坑第三式 class=headerlink title=踏坑第三式></a>踏坑第三式</h2><p>部分手机第三方输入法会将页面网上挤的问题</p><figure class="highlight js"><table><tr><td class=gutter><pre><div class=line>1</div><div class=line>2</div><div class=line>3</div><div class=line>4</div><div class=line>5</div><div class=line>6</div></pre></td><td class=code><pre><div class=line><span class=comment>// 特定需求页面，比如评论页面，输入框在顶部之类的</span></div><div class=line><span class=keyword>const</span> interval = setInterval(<span class=function><span class=keyword>function</span>(<span class=params></span>) </span>&#123;</div><div class=line>    <span class=built_in>document</span>.body.scrollTop = <span class=number>0</span>;</div><div class=line>&#125;, <span class=number>100</span>)</div><div class=line><span class=comment>// 注意关闭页面或者销毁组件的时候记得清空定时器</span></div><div class=line>clearInterval(interval);</div></pre></td></tr></table></figure><h2 id=踏坑第四式><a href=#踏坑第四式 class=headerlink title=踏坑第四式></a>踏坑第四式</h2><p>iPhoneX适配</p><figure class="highlight html"><table><tr><td class=gutter><pre><div class=line>1</div><div class=line>2</div><div class=line>3</div><div class=line>4</div><div class=line>5</div><div class=line>6</div><div class=line>7</div><div class=line>8</div><div class=line>9</div><div class=line>10</div><div class=line>11</div><div class=line>12</div><div class=line>13</div></pre></td><td class=code><pre><div class=line>// 1.viewport meta 标签增加属性viewport-fit=cover</div><div class=line><span class=tag>&lt;<span class=name>meta</span> <span class=attr>name</span>=<span class=string>"viewport"</span> <span class=attr>content</span>=<span class=string>"width=device-width, viewport-fit=cover, xxxx"</span>&gt;</span></div><div class=line>// 2.body元素增加样式</div><div class=line>body &#123;</div><div class=line>  padding-bottom: constant(safe-area-inset-bottom);</div><div class=line>  padding-bottom: env(safe-area-inset-bottom);</div><div class=line>&#125;</div><div class=line>// 3.如有fixed底部的元素，也增加上面样式</div><div class=line>xxx &#123;</div><div class=line>  padding-bottom: constant(safe-area-inset-bottom);</div><div class=line>  padding-bottom: env(safe-area-inset-bottom);</div><div class=line>  background-color: #fff; // 记得添加background-color，不然会出现透明镂空的情况</div><div class=line>&#125;</div></pre></td></tr></table></figure><h2 id=踏坑第五式><a href=#踏坑第五式 class=headerlink title=踏坑第五式></a>踏坑第五式</h2><p>某些机型不支持video标签的poster属性，特别是安卓<br><figure class="highlight stylus"><table><tr><td class=gutter><pre><div class=line>1</div><div class=line>2</div><div class=line>3</div><div class=line>4</div><div class=line>5</div><div class=line>6</div><div class=line>7</div><div class=line>8</div><div class=line>9</div><div class=line>10</div><div class=line>11</div><div class=line>12</div><div class=line>13</div><div class=line>14</div><div class=line>15</div><div class=line>16</div><div class=line>17</div><div class=line>18</div><div class=line>19</div></pre></td><td class=code><pre><div class=line>用图片元素 &lt;<span class=selector-tag>img</span> /&gt;来代替poster</div><div class=line>播放前显示&lt;<span class=selector-tag>img</span> /&gt;，隐藏 &lt;<span class=selector-tag>video</span> /&gt;</div><div class=line>播放后显示&lt;<span class=selector-tag>video</span> /&gt;，隐藏 &lt;<span class=selector-tag>img</span> /&gt;</div><div class=line>踏坑第六式</div><div class=line>CSS透明度颜色设置问题</div><div class=line></div><div class=line>Android部分不支持 hex写法，推荐用rgba的写法</div><div class=line><span class=number>#000000</span>9c --&gt; rgba(<span class=number>0</span>, <span class=number>0</span>, <span class=number>0</span>, <span class=number>0.61</span>)</div><div class=line>踏坑第七式</div><div class=line><span class=attribute>flex</span>对低版本的ios和Android的支持问题</div><div class=line></div><div class=line>使用postcss的autoprefixer插件，自动添加浏览器内核前缀，</div><div class=line>并且增加更低浏览器版本的配置，自动添加<span class=attribute>flex</span>老版本的属性和写法</div><div class=line>autoprefixer(&#123;</div><div class=line>    browsers: [</div><div class=line>        <span class=string>'iOS &gt;= 6'</span>,     <span class=comment>// 特殊处理支持低版本IOS</span></div><div class=line>        <span class=string>'Safari &gt;= 6'</span>,  <span class=comment>// 特殊处理支持低版本Safari</span></div><div class=line>    ],</div><div class=line>&#125;),</div></pre></td></tr></table></figure></p><h2 id=踏坑第八式><a href=#踏坑第八式 class=headerlink title=踏坑第八式></a>踏坑第八式</h2><p>ios 页面回退到长列表出现灰色遮挡问题<br>demo截图demo截图<br><figure class="highlight lsl"><table><tr><td class=gutter><pre><div class=line>1</div><div class=line>2</div><div class=line>3</div><div class=line>4</div><div class=line>5</div><div class=line>6</div></pre></td><td class=code><pre><div class=line>方案<span class=number>1</span>：对列表数据进行缓存，比如redux之类的用法。</div><div class=line>方案<span class=number>2</span>：回退时，跳到页面顶部。</div><div class=line>const <span class=section>timer</span> = setTimeout(() =&gt; &#123;</div><div class=line>    window.scrollTo(<span class=number>0</span>, <span class=number>1</span>);</div><div class=line>    window.scrollTo(<span class=number>0</span>, <span class=number>0</span>);</div><div class=line>&#125;, <span class=number>0</span>);</div></pre></td></tr></table></figure></p><h2 id=踏坑第九式><a href=#踏坑第九式 class=headerlink title=踏坑第九式></a>踏坑第九式</h2><p>ios 日期转换NAN的问题<br><figure class="highlight awk"><table><tr><td class=gutter><pre><div class=line>1</div><div class=line>2</div></pre></td><td class=code><pre><div class=line>将日期字符串的格式符号替换成<span class=string>'/'</span>。</div><div class=line>栗子：<span class=string>'yyyy-MM-dd'</span>.replace(<span class=regexp>/-/g</span>, <span class=string>'/'</span>)</div></pre></td></tr></table></figure></p></div><div id=side-right-bar><div class=close-right-bar></div><div class=sidebar-toc><div class=sidebar-toc__title>目录</div><div class=sidebar-toc__progress><span class=progress-notice>你已经阅读了</span><span class=progress-num>0</span><span class=progress-percentage>%</span><div class=sidebar-toc__progress-bar></div></div><div class=sidebar-toc__content><ol class=toc><li class="toc-item toc-level-2"><a class=toc-link href=#踏坑第一式><span class=toc-number>1.</span> <span class=toc-text>踏坑第一式</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#踏坑第二式><span class=toc-number>2.</span> <span class=toc-text>踏坑第二式</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#踏坑第三式><span class=toc-number>3.</span> <span class=toc-text>踏坑第三式</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#踏坑第四式><span class=toc-number>4.</span> <span class=toc-text>踏坑第四式</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#踏坑第五式><span class=toc-number>5.</span> <span class=toc-text>踏坑第五式</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#踏坑第八式><span class=toc-number>6.</span> <span class=toc-text>踏坑第八式</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#踏坑第九式><span class=toc-number>7.</span> <span class=toc-text>踏坑第九式</span></a></li></ol></div></div></div><div class=right-btn id=right-btn><span>目录</span></div><div class=article-bottom><div class="addthis_inline_share_toolbox fr"></div></div><div class=post-copyright><div class=post-copyright__author><span class=post-copyright-meta>文章作者:</span><span class=post-copyright-info><a href=mailto:undefined>CavinHuang</a></span></div><div class=post-copyright__type><span class=post-copyright-meta>文章链接:</span><span class=post-copyright-info><a href="http://blog.zukmb.cnH5手机端开发问题汇总及解决方案/">http://blog.zukmb.cnH5手机端开发问题汇总及解决方案/</a></span></div><div class=post-copyright__notice><span class=post-copyright-meta>版权声明:</span><span class=post-copyright-info>转载请注明来自<a href=http://blog.zukmb.cn target=_blank style="font-size: 18px;">CavinHuangのBlog</a>！</span></div></div><div class=article-pagenate><div class="article-prev fl"><span>←</span><a href="/git-push出现git-remote-error-hook-declined-to-update/">git push出现git remote: error: hook declined to update</a></div><div class="article-next fr"><a href="/正则表达式解析一个完整的url/">正则表达式解析一个完整的url</a><span>→</span></div></div></article></div><footer class=footer><div id=toTop style="display: none;">Back to Top</div></footer></div></div><canvas class=fireworks></canvas><script src=/js/velocity.ui.min.js></script><script src=/js/yoyo.js></script><script src=/js/scroll.js></script><script src=/js/particle.js></script><script src=/js/anime.min.js></script><script src=/js/fireworks.js></script>