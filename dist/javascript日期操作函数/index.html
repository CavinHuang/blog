<!DOCTYPE html><html lang=zh><head><meta charset=UTF-8><meta name=baidu-site-verification content=rqskM4bdtP><meta name=viewport content="device-width, initial-scale=1, maximum-scale=1,user-scalable=no"><title>javascript日期操作函数-CavinHuang-不懂写故事的猫-http://blog.zukmb.cn</title><meta name=keywords content=前端学习,php学习,个人博客,HTML,CSS,JS><meta name=description content=cavinHuang个人博客，这里记录学习和生活的点滴！><meta name=google-site-verification content=zOYxWUgmeogC0qY76WLP0eWl8r9E8jk_qU927Ij7tbs><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5a4c3745fa28006f"></script><link rel=stylesheet href=/css/yoyo.css><link rel=icon href=/img/favicon.png><link rel=stylesheet href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css?version=1.3"><script src=//cdn.bootcss.com/jquery/3.2.1/jquery.min.js></script><script src=//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js></script><script src=https://cdn.bootcss.com/velocity/1.5.0/velocity.min.js></script></head><body></body></html><div class=app><div class=left-container><canvas id=cas></canvas><div class="left-layout-container pc"><div class=user-info><a href="/"><img src="https://avatars1.githubusercontent.com/u/24950299?s=460&amp;v=4"></a><div class=login-name>CavinHuang</div><div class=slog>来不及总结自己,愿天大地大,我独一无二!</div></div><ul class=other-site><li><img src=http://www.17sucai.com/preview/177065/2017-09-28/Mon9/static/img/github.png></li><li><img src=http://www.17sucai.com/preview/177065/2017-09-28/Mon9/static/img/weibo.png></li></ul><ul class=left-menu><li><a href=/archives>文章</a></li><li><a href=/categories>分类</a></li><li><a href=/tags>标签</a></li><li><a href=/about>关于</a></li></ul><div class=qq-group><span>读万卷书</span><span>行万里路</span></div><div class=copyright>@ 2017 - 2017 CavinHuang</div></div></div><div class="blog-container main-container" id=content-outer><div class=blog-list-container id=content-inner><article class=article-container id=post><div class=article-header><h1 class=article-title>javascript日期操作函数</h1><div class=article-subtitle><div class="publish-time fl">发布时间:<span>2017/3/15 9:49:20</span></div><div class=categories>分类:</div></div></div><div class=article-content><blockquote><p>函数目录<br>getFormatDateStr 获得指定日期格式的字符串；<br>getDayPrevAfter 获得n天前/后的日期；<br><a id=more></a><br>formatDateWithTimeZone 格式化日期带时区，ISO 8601；<br>countDownBySecond 倒计时；<br>monthSize 获得指定日期所在月的天数；<br>getCalendarMonth 获得指定日期所在月的第一周到第四/五周的数据组合；<br>getOneDateWeekIndex 获得指定的某天所在该月的第几周，下标从0开始；<br>下面是详细的说明：</p></blockquote><h3 id=getFormatDateStr><a href=#getFormatDateStr class=headerlink title=getFormatDateStr></a>getFormatDateStr</h3><figure class="highlight javascript"><table><tr><td class=gutter><pre><div class=line>1</div><div class=line>2</div><div class=line>3</div><div class=line>4</div><div class=line>5</div><div class=line>6</div><div class=line>7</div><div class=line>8</div><div class=line>9</div><div class=line>10</div><div class=line>11</div><div class=line>12</div><div class=line>13</div><div class=line>14</div><div class=line>15</div><div class=line>16</div><div class=line>17</div><div class=line>18</div><div class=line>19</div><div class=line>20</div><div class=line>21</div><div class=line>22</div><div class=line>23</div><div class=line>24</div><div class=line>25</div><div class=line>26</div><div class=line>27</div><div class=line>28</div><div class=line>29</div><div class=line>30</div><div class=line>31</div><div class=line>32</div><div class=line>33</div><div class=line>34</div><div class=line>35</div><div class=line>36</div><div class=line>37</div><div class=line>38</div><div class=line>39</div><div class=line>40</div><div class=line>41</div><div class=line>42</div><div class=line>43</div><div class=line>44</div><div class=line>45</div><div class=line>46</div><div class=line>47</div><div class=line>48</div><div class=line>49</div><div class=line>50</div><div class=line>51</div><div class=line>52</div><div class=line>53</div><div class=line>54</div><div class=line>55</div><div class=line>56</div><div class=line>57</div><div class=line>58</div><div class=line>59</div><div class=line>60</div><div class=line>61</div><div class=line>62</div><div class=line>63</div><div class=line>64</div><div class=line>65</div><div class=line>66</div><div class=line>67</div><div class=line>68</div><div class=line>69</div><div class=line>70</div><div class=line>71</div><div class=line>72</div><div class=line>73</div><div class=line>74</div><div class=line>75</div><div class=line>76</div><div class=line>77</div><div class=line>78</div><div class=line>79</div><div class=line>80</div><div class=line>81</div><div class=line>82</div><div class=line>83</div><div class=line>84</div><div class=line>85</div><div class=line>86</div><div class=line>87</div><div class=line>88</div><div class=line>89</div><div class=line>90</div><div class=line>91</div><div class=line>92</div><div class=line>93</div><div class=line>94</div><div class=line>95</div><div class=line>96</div><div class=line>97</div><div class=line>98</div><div class=line>99</div><div class=line>100</div><div class=line>101</div><div class=line>102</div><div class=line>103</div><div class=line>104</div><div class=line>105</div><div class=line>106</div><div class=line>107</div><div class=line>108</div><div class=line>109</div><div class=line>110</div><div class=line>111</div><div class=line>112</div><div class=line>113</div><div class=line>114</div><div class=line>115</div><div class=line>116</div><div class=line>117</div><div class=line>118</div></pre></td><td class=code><pre><div class=line><span class=comment>/**</span></div><div class=line><span class=comment> * [zeroPadding 小于10的数字补0，必填]</span></div><div class=line><span class=comment> * @param  &#123;[Int]&#125; value [description]</span></div><div class=line><span class=comment> * @return &#123;[String]&#125;       [description]</span></div><div class=line><span class=comment> */</span></div><div class=line><span class=keyword>export</span> <span class=function><span class=keyword>function</span> <span class=title>zeroPadding</span>(<span class=params>value</span>)</span>&#123;</div><div class=line>  <span class=keyword>return</span> value &lt; <span class=number>10</span> ? <span class=string>`0<span class=subst>$&#123;value&#125;</span>`</span> : value;</div><div class=line>&#125;</div><div class=line></div><div class=line><span class=comment>/**</span></div><div class=line><span class=comment> * [_isDateStrSeparatorCh 判断日期格式字符串的分隔符是否是中文]</span></div><div class=line><span class=comment> * @param  &#123;[String]&#125; str [必填]</span></div><div class=line><span class=comment> * @return &#123;[String]&#125;     [分隔符]</span></div><div class=line><span class=comment> */</span></div><div class=line><span class=function><span class=keyword>function</span> <span class=title>_getDateStrSeparator</span>(<span class=params>str, startIndex, endIndex</span>) </span>&#123;</div><div class=line>  startIndex = startIndex ? startIndex : <span class=number>4</span>;</div><div class=line>  endIndex = endIndex ? endIndex : <span class=number>5</span>;</div><div class=line>  <span class=keyword>let</span> separator = str.slice(startIndex, endIndex);</div><div class=line>  <span class=keyword>if</span> (separator === <span class=string>'年'</span> || separator === <span class=string>'月'</span> ) &#123;</div><div class=line>    separator = <span class=string>'Ch'</span>;</div><div class=line>  &#125;</div><div class=line>  <span class=keyword>return</span> separator;</div><div class=line>&#125;</div><div class=line></div><div class=line><span class=comment>/**</span></div><div class=line><span class=comment> * [_isDateStrSeparatorCh 判断日期格式字符串的分隔符是否是中文]</span></div><div class=line><span class=comment> * @param  &#123;[String]&#125; str [必填]</span></div><div class=line><span class=comment> * @return &#123;[String]&#125;     [分隔符]</span></div><div class=line><span class=comment> */</span></div><div class=line><span class=function><span class=keyword>function</span> <span class=title>_isDateStrSeparatorCh</span>(<span class=params>str</span>) </span>&#123;</div><div class=line>  <span class=keyword>if</span> ( str.indexOf(<span class=string>'年'</span>)!=<span class=number>-1</span> || str.indexOf(<span class=string>'月'</span>)!=<span class=number>-1</span> ) &#123;</div><div class=line>    <span class=keyword>return</span> <span class=literal>true</span>;</div><div class=line>  &#125;</div><div class=line>  <span class=keyword>return</span> <span class=literal>false</span>;</div><div class=line>&#125;</div><div class=line></div><div class=line><span class=comment>/**</span></div><div class=line><span class=comment> * [getFormatDateStr 获得指定日期格式的字符串]</span></div><div class=line><span class=comment> * @param  &#123;[String or Date]&#125;  date  [要转换的日期，必填]</span></div><div class=line><span class=comment> * @param  &#123;[String]&#125;  dateFormatStr     [要转化的目标格式，必填，2016-11-22之间的分隔符可任意，可选项：</span></div><div class=line><span class=comment> * 'yyyy-mm-dd hh:mm:ss','yyyy/mm/dd hh:mm:ss','yyyy.mm.dd hh:mm:ss','yyyy年mm月dd hh:mm:ss',</span></div><div class=line><span class=comment> * 'yyyy-mm-dd hh:mm',</span></div><div class=line><span class=comment> * 'mm-dd hh:mm',</span></div><div class=line><span class=comment> * 'yyyy-mm-dd',</span></div><div class=line><span class=comment> * 'mm-dd',</span></div><div class=line><span class=comment> * 'hh:mm:ss',</span></div><div class=line><span class=comment> * 'hh:mm'</span></div><div class=line><span class=comment> * ]</span></div><div class=line><span class=comment> * @return &#123;[String]&#125;                [时间格式字符串]</span></div><div class=line><span class=comment> */</span></div><div class=line><span class=keyword>export</span> <span class=function><span class=keyword>function</span> <span class=title>getFormatDateStr</span>(<span class=params>date, dateFormatStr</span>) </span>&#123;</div><div class=line></div><div class=line>    <span class=keyword>if</span> ( !(date <span class=keyword>instanceof</span> <span class=built_in>Date</span>) ) &#123;</div><div class=line>      <span class=keyword>if</span> ( date.indexOf(<span class=string>'-'</span>) != <span class=number>-1</span> ) &#123;</div><div class=line>        date.replace(<span class=regexp>/\-/g</span>,<span class=string>'/'</span>);</div><div class=line>      &#125;</div><div class=line>          date = <span class=keyword>new</span> <span class=built_in>Date</span>(date);</div><div class=line>      &#125;</div><div class=line></div><div class=line>    dateFormatStr = dateFormatStr.toLowerCase();</div><div class=line>    <span class=keyword>if</span> (!dateFormatStr)&#123;</div><div class=line>      <span class=keyword>return</span> <span class=literal>false</span>;</div><div class=line>    &#125;</div><div class=line></div><div class=line>    <span class=keyword>let</span> returnStr = <span class=string>''</span>,</div><div class=line>        separator = _getDateStrSeparator(dateFormatStr),</div><div class=line>        year = date.getFullYear(),</div><div class=line>            month = date.getMonth() + <span class=number>1</span>,</div><div class=line>            day = date.getDate(),</div><div class=line>            hour = date.getHours(),</div><div class=line>            minute = date.getMinutes(),</div><div class=line>        second = date.getSeconds();</div><div class=line></div><div class=line>    <span class=keyword>if</span> ( <span class=regexp>/^yyyy(.&#123;1&#125;)mm(.&#123;1&#125;)dd hh:mm:ss$/</span>.test(dateFormatStr) ) &#123;</div><div class=line>      <span class=keyword>if</span> (_isDateStrSeparatorCh(dateFormatStr)) &#123;</div><div class=line>        returnStr = <span class=string>`<span class=subst>$&#123;year&#125;</span>年<span class=subst>$&#123;zeroPadding(month)&#125;</span>月<span class=subst>$&#123;zeroPadding(day)&#125;</span>日`</span>;</div><div class=line>      &#125; <span class=keyword>else</span> &#123;</div><div class=line>        separator =</div><div class=line>        returnStr = <span class=string>`<span class=subst>$&#123;year&#125;</span><span class=subst>$&#123;separator&#125;</span><span class=subst>$&#123;zeroPadding(month)&#125;</span><span class=subst>$&#123;separator&#125;</span><span class=subst>$&#123;zeroPadding(day)&#125;</span>`</span>;</div><div class=line>      &#125;</div><div class=line>      returnStr += <span class=string>` <span class=subst>$&#123;zeroPadding(hour)&#125;</span>:<span class=subst>$&#123;zeroPadding(minute)&#125;</span>:<span class=subst>$&#123;zeroPadding(second)&#125;</span>`</span>;</div><div class=line>    &#125; <span class=keyword>else</span> <span class=keyword>if</span> ( <span class=regexp>/^yyyy(.&#123;1&#125;)mm(.&#123;1&#125;)dd hh:mm$/</span>.test(dateFormatStr) ) &#123;</div><div class=line>      <span class=keyword>if</span> (_isDateStrSeparatorCh(dateFormatStr)) &#123;</div><div class=line>        returnStr = <span class=string>`<span class=subst>$&#123;year&#125;</span>年<span class=subst>$&#123;zeroPadding(month)&#125;</span>月<span class=subst>$&#123;zeroPadding(day)&#125;</span>日`</span>;</div><div class=line>      &#125; <span class=keyword>else</span> &#123;</div><div class=line>        returnStr = <span class=string>`<span class=subst>$&#123;year&#125;</span><span class=subst>$&#123;separator&#125;</span><span class=subst>$&#123;zeroPadding(month)&#125;</span><span class=subst>$&#123;separator&#125;</span><span class=subst>$&#123;zeroPadding(day)&#125;</span>`</span>;</div><div class=line>      &#125;</div><div class=line>      returnStr += <span class=string>` <span class=subst>$&#123;zeroPadding(hour)&#125;</span>:<span class=subst>$&#123;zeroPadding(minute)&#125;</span>`</span>;</div><div class=line>    &#125; <span class=keyword>else</span> <span class=keyword>if</span> ( <span class=regexp>/^mm(.&#123;1&#125;)dd hh:mm$/</span>.test(dateFormatStr) ) &#123;</div><div class=line>      <span class=keyword>if</span> (_isDateStrSeparatorCh(dateFormatStr)) &#123;</div><div class=line>        returnStr = <span class=string>`<span class=subst>$&#123;zeroPadding(month)&#125;</span>月<span class=subst>$&#123;zeroPadding(day)&#125;</span>日`</span>;</div><div class=line>      &#125; <span class=keyword>else</span> &#123;</div><div class=line>        separator = _getDateStrSeparator(dateFormatStr, <span class=number>2</span>, <span class=number>3</span>);</div><div class=line>        returnStr = <span class=string>`<span class=subst>$&#123;zeroPadding(month)&#125;</span><span class=subst>$&#123;separator&#125;</span><span class=subst>$&#123;zeroPadding(day)&#125;</span>`</span>;</div><div class=line>      &#125;</div><div class=line>      returnStr += <span class=string>` <span class=subst>$&#123;zeroPadding(hour)&#125;</span>:<span class=subst>$&#123;zeroPadding(minute)&#125;</span>`</span>;</div><div class=line>    &#125; <span class=keyword>else</span> <span class=keyword>if</span> ( <span class=regexp>/^yyyy(.&#123;1&#125;)mm(.&#123;1&#125;)dd$/</span>.test(dateFormatStr) ) &#123;</div><div class=line>      <span class=keyword>if</span> (_isDateStrSeparatorCh(dateFormatStr)) &#123;</div><div class=line>        returnStr = <span class=string>`<span class=subst>$&#123;year&#125;</span>年<span class=subst>$&#123;zeroPadding(month)&#125;</span>月<span class=subst>$&#123;zeroPadding(day)&#125;</span>日`</span>;</div><div class=line>      &#125; <span class=keyword>else</span> &#123;</div><div class=line>        returnStr = <span class=string>`<span class=subst>$&#123;year&#125;</span><span class=subst>$&#123;separator&#125;</span><span class=subst>$&#123;zeroPadding(month)&#125;</span><span class=subst>$&#123;separator&#125;</span><span class=subst>$&#123;zeroPadding(day)&#125;</span>`</span>;</div><div class=line>      &#125;</div><div class=line>    &#125; <span class=keyword>else</span> <span class=keyword>if</span> ( <span class=regexp>/^mm(.&#123;1&#125;)dd$/</span>.test(dateFormatStr) ) &#123;</div><div class=line>      <span class=keyword>if</span> (_isDateStrSeparatorCh(dateFormatStr)) &#123;</div><div class=line>        returnStr = <span class=string>`<span class=subst>$&#123;zeroPadding(month)&#125;</span>月<span class=subst>$&#123;zeroPadding(day)&#125;</span>日`</span>;</div><div class=line>      &#125; <span class=keyword>else</span> &#123;</div><div class=line>        separator = _getDateStrSeparator(dateFormatStr, <span class=number>2</span>, <span class=number>3</span>);</div><div class=line>        returnStr = <span class=string>`<span class=subst>$&#123;zeroPadding(month)&#125;</span><span class=subst>$&#123;separator&#125;</span><span class=subst>$&#123;zeroPadding(day)&#125;</span>`</span>;</div><div class=line>      &#125;</div><div class=line>    &#125; <span class=keyword>else</span> <span class=keyword>if</span> ( <span class=regexp>/^hh:mm:ss$/</span>.test(dateFormatStr) ) &#123;</div><div class=line>      returnStr = <span class=string>`<span class=subst>$&#123;zeroPadding(hour)&#125;</span>:<span class=subst>$&#123;zeroPadding(minute)&#125;</span>:<span class=subst>$&#123;zeroPadding(second)&#125;</span>`</span>;</div><div class=line>    &#125; <span class=keyword>else</span> <span class=keyword>if</span> ( <span class=regexp>/^hh:mm$/</span>.test(dateFormatStr) ) &#123;</div><div class=line>      returnStr = <span class=string>`<span class=subst>$&#123;zeroPadding(hour)&#125;</span>:<span class=subst>$&#123;zeroPadding(minute)&#125;</span>`</span>;</div><div class=line>    &#125;</div><div class=line></div><div class=line>  <span class=keyword>return</span> returnStr;</div><div class=line></div><div class=line>&#125;</div></pre></td></tr></table></figure><h3 id=getDayPrevAfter><a href=#getDayPrevAfter class=headerlink title=getDayPrevAfter></a>getDayPrevAfter</h3><figure class="highlight javascript"><table><tr><td class=gutter><pre><div class=line>1</div><div class=line>2</div><div class=line>3</div><div class=line>4</div><div class=line>5</div><div class=line>6</div><div class=line>7</div><div class=line>8</div><div class=line>9</div><div class=line>10</div><div class=line>11</div><div class=line>12</div><div class=line>13</div><div class=line>14</div><div class=line>15</div><div class=line>16</div><div class=line>17</div><div class=line>18</div><div class=line>19</div><div class=line>20</div><div class=line>21</div><div class=line>22</div><div class=line>23</div><div class=line>24</div><div class=line>25</div><div class=line>26</div><div class=line>27</div><div class=line>28</div><div class=line>29</div></pre></td><td class=code><pre><div class=line><span class=comment>/**</span></div><div class=line><span class=comment> * [getDayPrevAfter 获得n天前/后的日期]</span></div><div class=line><span class=comment> * @param  &#123;[String]&#125; date    [日期，非必填参数，表示调用时的时间]</span></div><div class=line><span class=comment> * @param  &#123;[String]&#125; type    [前一天还是后一天，非必填参数，默认后一天]</span></div><div class=line><span class=comment> * @param  &#123;[Int]&#125; daysNum [天数，非必填参数，默认一天]</span></div><div class=line><span class=comment> * @return &#123;[Date]&#125;         [description]</span></div><div class=line><span class=comment> */</span></div><div class=line><span class=keyword>export</span> <span class=function><span class=keyword>function</span> <span class=title>getDayPrevAfter</span>(<span class=params>date, type, daysNum</span>) </span>&#123;</div><div class=line></div><div class=line>  date = date ? date : <span class=keyword>new</span> <span class=built_in>Date</span>();</div><div class=line>  type = type ? type : <span class=string>'after'</span>;</div><div class=line>  daysNum = daysNum ? daysNum : <span class=number>1</span>;</div><div class=line></div><div class=line>  <span class=keyword>if</span> ( !(date <span class=keyword>instanceof</span> <span class=built_in>Date</span>) ) &#123;</div><div class=line>    <span class=keyword>if</span> ( date.indexOf(<span class=string>'-'</span>) != <span class=number>-1</span> ) &#123;</div><div class=line>      date.replace(<span class=regexp>/\-/g</span>,<span class=string>'/'</span>);</div><div class=line>    &#125;</div><div class=line>    date = <span class=keyword>new</span> <span class=built_in>Date</span>(date);</div><div class=line>  &#125;</div><div class=line></div><div class=line>  <span class=keyword>let</span> returnDate = date;</div><div class=line>  <span class=keyword>if</span> (type === <span class=string>'prev'</span>) &#123;</div><div class=line>    returnDate = <span class=keyword>new</span> <span class=built_in>Date</span>(date.getTime() - (daysNum * <span class=number>24</span> * <span class=number>60</span> * <span class=number>60</span> * <span class=number>1000</span>));</div><div class=line>  &#125; <span class=keyword>else</span> <span class=keyword>if</span> (type === <span class=string>'after'</span>) &#123;</div><div class=line>    returnDate = <span class=keyword>new</span> <span class=built_in>Date</span>(date.getTime() + (daysNum * <span class=number>24</span> * <span class=number>60</span> * <span class=number>60</span> * <span class=number>1000</span>));</div><div class=line>  &#125;</div><div class=line>  <span class=keyword>return</span> returnDate;</div><div class=line></div><div class=line>&#125;</div></pre></td></tr></table></figure><h3 id=formatDateWithTimeZone><a href=#formatDateWithTimeZone class=headerlink title=formatDateWithTimeZone></a>formatDateWithTimeZone</h3><figure class="highlight javascript"><table><tr><td class=gutter><pre><div class=line>1</div><div class=line>2</div><div class=line>3</div><div class=line>4</div><div class=line>5</div><div class=line>6</div><div class=line>7</div><div class=line>8</div><div class=line>9</div><div class=line>10</div><div class=line>11</div><div class=line>12</div><div class=line>13</div><div class=line>14</div><div class=line>15</div><div class=line>16</div><div class=line>17</div><div class=line>18</div><div class=line>19</div><div class=line>20</div><div class=line>21</div><div class=line>22</div><div class=line>23</div><div class=line>24</div></pre></td><td class=code><pre><div class=line><span class=comment>/**</span></div><div class=line><span class=comment> * [formatDateWithTimeZone 格式化日期带时区，ISO 8601]</span></div><div class=line><span class=comment> * @param  &#123;[Date]&#125; date [日期，非必填参数，表示调用时的时间]</span></div><div class=line><span class=comment> * @return &#123;[String]&#125;     [ISO 8601格式的日期，example: 2016-11-21T14:09:15+08:00]</span></div><div class=line><span class=comment> */</span></div><div class=line><span class=keyword>export</span> <span class=function><span class=keyword>function</span> <span class=title>formatDateWithTimeZone</span>(<span class=params>date</span>) </span>&#123;</div><div class=line></div><div class=line>  date = date ? date : <span class=keyword>new</span> <span class=built_in>Date</span>();</div><div class=line>  <span class=keyword>if</span> ( !(date <span class=keyword>instanceof</span> <span class=built_in>Date</span>) ) &#123;</div><div class=line>    <span class=keyword>if</span> ( date.indexOf(<span class=string>'-'</span>) != <span class=number>-1</span> ) &#123;</div><div class=line>      date.replace(<span class=regexp>/\-/g</span>,<span class=string>'/'</span>);</div><div class=line>    &#125;</div><div class=line>    date = <span class=keyword>new</span> <span class=built_in>Date</span>(date);</div><div class=line>  &#125;</div><div class=line></div><div class=line>  <span class=keyword>let</span> tzo = -date.getTimezoneOffset(),</div><div class=line>      dif = tzo &gt;= <span class=number>0</span> ? <span class=string>'+'</span> : <span class=string>'-'</span>,</div><div class=line>      pad = <span class=function><span class=keyword>function</span> (<span class=params>num</span>) </span>&#123;</div><div class=line>          <span class=keyword>let</span> norm = <span class=built_in>Math</span>.abs(<span class=built_in>Math</span>.floor(num));</div><div class=line>          <span class=keyword>return</span> zeroPadding(norm);</div><div class=line>      &#125;;</div><div class=line>    <span class=keyword>return</span> <span class=string>`<span class=subst>$&#123;date.getFullYear()&#125;</span>-<span class=subst>$&#123;pad(date.getMonth() + <span class=number>1</span>)&#125;</span>-<span class=subst>$&#123;pad(date.getDate())&#125;</span>T<span class=subst>$&#123;pad(date.getHours())&#125;</span>:<span class=subst>$&#123;pad(date.getMinutes())&#125;</span>:<span class=subst>$&#123;pad(date.getSeconds())&#125;</span><span class=subst>$&#123;dif&#125;</span><span class=subst>$&#123;pad(tzo <span class=regexp>/ 60)&#125;:$&#123;pad(tzo % 60)&#125;`;</span></span></span></div><div class=line><span class=string><span class=subst><span class=regexp></span></span></span></div><div class=line><span class=string><span class=subst><span class=regexp>&#125;</span></span></span></div></pre></td></tr></table></figure><h3 id=countDownBySecond><a href=#countDownBySecond class=headerlink title=countDownBySecond></a>countDownBySecond</h3><figure class="highlight javascript"><table><tr><td class=gutter><pre><div class=line>1</div><div class=line>2</div><div class=line>3</div><div class=line>4</div><div class=line>5</div><div class=line>6</div><div class=line>7</div><div class=line>8</div><div class=line>9</div><div class=line>10</div><div class=line>11</div><div class=line>12</div><div class=line>13</div><div class=line>14</div><div class=line>15</div><div class=line>16</div><div class=line>17</div><div class=line>18</div><div class=line>19</div><div class=line>20</div><div class=line>21</div></pre></td><td class=code><pre><div class=line><span class=comment>/**</span></div><div class=line><span class=comment> * [countDownBySecond 倒计时]</span></div><div class=line><span class=comment> * @param  &#123;[Int]&#125; restSeconds   [剩余秒数，必填]</span></div><div class=line><span class=comment> * @param  &#123;[Int]&#125; timeInterval   [时间间隔，非必填，默认1000ms]</span></div><div class=line><span class=comment> * @param  &#123;[Function]&#125; func   [每倒计时一次，就需要执行一次的回调函数名，非必填]</span></div><div class=line><span class=comment> * @param  &#123;[Function]&#125; endFun [倒计时结束需要执行的函数名，非必填]</span></div><div class=line><span class=comment> * @return &#123;[null]&#125;        [无返回值]</span></div><div class=line><span class=comment> */</span></div><div class=line><span class=keyword>export</span> <span class=function><span class=keyword>function</span> <span class=title>countDownBySecond</span>(<span class=params>restSeconds, timeInterval, func, endCallback</span>) </span>&#123;</div><div class=line>    <span class=keyword>let</span> timer = <span class=literal>null</span>;</div><div class=line>    <span class=keyword>let</span> total = restSeconds;</div><div class=line>    timeInterval = timeInterval ? timeInterval : <span class=number>1000</span>;</div><div class=line>    timer = setInterval(<span class=function><span class=keyword>function</span>(<span class=params></span>) </span>&#123;</div><div class=line>        --total;</div><div class=line>        <span class=keyword>if</span> (total &lt;= <span class=number>0</span>) &#123;</div><div class=line>            clearInterval(timer);</div><div class=line>            endCallback &amp;&amp; endCallback();</div><div class=line>        &#125;</div><div class=line>        func &amp;&amp; func(total);</div><div class=line>    &#125;, timeInterval);</div><div class=line>&#125;</div></pre></td></tr></table></figure><h3 id=monthSize><a href=#monthSize class=headerlink title=monthSize></a>monthSize</h3><figure class="highlight javascript"><table><tr><td class=gutter><pre><div class=line>1</div><div class=line>2</div><div class=line>3</div><div class=line>4</div><div class=line>5</div><div class=line>6</div><div class=line>7</div><div class=line>8</div><div class=line>9</div><div class=line>10</div><div class=line>11</div><div class=line>12</div><div class=line>13</div><div class=line>14</div></pre></td><td class=code><pre><div class=line><span class=comment>/**</span></div><div class=line><span class=comment> * [monthSize 获得指定日期所在月的天数]</span></div><div class=line><span class=comment> * @param  &#123;[Date]&#125; oDate [指定的日期，非必填，默认为当天]</span></div><div class=line><span class=comment> * @return &#123;[Int]&#125;       [总天数]</span></div><div class=line><span class=comment> */</span></div><div class=line><span class=function><span class=keyword>function</span> <span class=title>monthSize</span>(<span class=params>oDate</span>) </span>&#123;</div><div class=line>    oDate = oDate ? oDate : <span class=keyword>new</span> <span class=built_in>Date</span>();</div><div class=line>    <span class=keyword>let</span> year = oDate.getFullYear(),</div><div class=line>        month = oDate.getMonth(),</div><div class=line>        _oDate = <span class=keyword>new</span> <span class=built_in>Date</span>();</div><div class=line>    _oDate.setFullYear(year);</div><div class=line>    _oDate.setMonth(month + <span class=number>1</span>, <span class=number>0</span>);</div><div class=line>    <span class=keyword>return</span> _oDate.getDate();</div><div class=line>&#125;</div></pre></td></tr></table></figure><h3 id=getCalendarMonth><a href=#getCalendarMonth class=headerlink title=getCalendarMonth></a>getCalendarMonth</h3><figure class="highlight javascript"><table><tr><td class=gutter><pre><div class=line>1</div><div class=line>2</div><div class=line>3</div><div class=line>4</div><div class=line>5</div><div class=line>6</div><div class=line>7</div><div class=line>8</div><div class=line>9</div><div class=line>10</div><div class=line>11</div><div class=line>12</div><div class=line>13</div><div class=line>14</div><div class=line>15</div><div class=line>16</div><div class=line>17</div><div class=line>18</div><div class=line>19</div><div class=line>20</div><div class=line>21</div><div class=line>22</div><div class=line>23</div><div class=line>24</div><div class=line>25</div><div class=line>26</div><div class=line>27</div><div class=line>28</div><div class=line>29</div><div class=line>30</div><div class=line>31</div><div class=line>32</div><div class=line>33</div><div class=line>34</div><div class=line>35</div><div class=line>36</div><div class=line>37</div><div class=line>38</div><div class=line>39</div><div class=line>40</div><div class=line>41</div><div class=line>42</div><div class=line>43</div><div class=line>44</div><div class=line>45</div><div class=line>46</div><div class=line>47</div><div class=line>48</div><div class=line>49</div><div class=line>50</div><div class=line>51</div><div class=line>52</div><div class=line>53</div><div class=line>54</div><div class=line>55</div><div class=line>56</div><div class=line>57</div><div class=line>58</div><div class=line>59</div><div class=line>60</div><div class=line>61</div><div class=line>62</div><div class=line>63</div><div class=line>64</div><div class=line>65</div><div class=line>66</div><div class=line>67</div><div class=line>68</div><div class=line>69</div><div class=line>70</div><div class=line>71</div><div class=line>72</div><div class=line>73</div><div class=line>74</div><div class=line>75</div><div class=line>76</div><div class=line>77</div><div class=line>78</div><div class=line>79</div><div class=line>80</div><div class=line>81</div><div class=line>82</div><div class=line>83</div><div class=line>84</div><div class=line>85</div><div class=line>86</div><div class=line>87</div><div class=line>88</div><div class=line>89</div><div class=line>90</div><div class=line>91</div><div class=line>92</div><div class=line>93</div></pre></td><td class=code><pre><div class=line><span class=comment>/**</span></div><div class=line><span class=comment> * [getCalendarMonth 获得指定日期所在月的第一周到第四/五周的数据组合，形如：</span></div><div class=line><span class=comment> * [&#123;</span></div><div class=line><span class=comment>    "date": "2016/10/30", //日期字符串</span></div><div class=line><span class=comment>    "dateNum": 30,  //日</span></div><div class=line><span class=comment>    "isCurMonth": false, //是否当前月</span></div><div class=line><span class=comment>    "weekIndex": 0 //是本月的第几周，下标从0开始</span></div><div class=line><span class=comment>  &#125;,&#123;</span></div><div class=line><span class=comment>    "date": "2016/10/31",</span></div><div class=line><span class=comment>    "dateNum": 31,</span></div><div class=line><span class=comment>    "isCurMonth": false,</span></div><div class=line><span class=comment>    "weekIndex": 0</span></div><div class=line><span class=comment>  &#125;,&#123;</span></div><div class=line><span class=comment>    "date": "2016/11/1",</span></div><div class=line><span class=comment>    "dateNum": 1,</span></div><div class=line><span class=comment>    "day": 2,</span></div><div class=line><span class=comment>    "isCurMonth": true,</span></div><div class=line><span class=comment>    "isToday": false,</span></div><div class=line><span class=comment>    "weekIndex": 0</span></div><div class=line><span class=comment>  &#125;]</span></div><div class=line><span class=comment>  ]</span></div><div class=line><span class=comment> * @param  &#123;[Date]&#125; param [指定的日期，非必填，默认为当天]</span></div><div class=line><span class=comment> * @return &#123;[Array]&#125;       [获得指定日期所在月的第一周到第四/五周的数据组合]</span></div><div class=line><span class=comment> */</span></div><div class=line><span class=keyword>export</span> <span class=function><span class=keyword>function</span> <span class=title>getCalendarMonth</span>(<span class=params>date</span>) </span>&#123;</div><div class=line>    date = date ? date : <span class=keyword>new</span> <span class=built_in>Date</span>();</div><div class=line>    <span class=keyword>let</span> y = date.getFullYear();</div><div class=line>    <span class=keyword>let</span> m = date.getMonth();</div><div class=line>    <span class=keyword>let</span> _m;</div><div class=line>    <span class=keyword>let</span> firstDay = <span class=keyword>new</span> <span class=built_in>Date</span>(y, m, <span class=number>1</span>).getDay(); <span class=comment>//当月第一天 周期</span></div><div class=line>    <span class=keyword>let</span> days = monthSize(date);<span class=comment>//当月天数</span></div><div class=line>    <span class=keyword>let</span> prevMonthDays = monthSize(<span class=keyword>new</span> <span class=built_in>Date</span>(y, m - <span class=number>1</span>));<span class=comment>//上月天数</span></div><div class=line>    <span class=keyword>let</span> initPrevDay = prevMonthDays - firstDay;</div><div class=line>    <span class=keyword>let</span> lines = <span class=built_in>Math</span>.ceil((firstDay + days) / <span class=number>7</span>);</div><div class=line>    _m = <span class=keyword>new</span> <span class=built_in>Array</span>(lines * <span class=number>7</span>);</div><div class=line>    <span class=keyword>let</span> nextMonthDay = <span class=number>0</span>;</div><div class=line></div><div class=line>    <span class=keyword>for</span> (<span class=keyword>let</span> i = <span class=number>0</span>; i &lt; _m.length; i++) &#123;</div><div class=line>        <span class=keyword>let</span> weekIndex = <span class=built_in>parseInt</span>(i / <span class=number>7</span>);</div><div class=line>        <span class=keyword>if</span> (i &lt; firstDay) &#123;</div><div class=line>            <span class=keyword>let</span> date = ++initPrevDay;</div><div class=line>            <span class=keyword>if</span> (m === <span class=number>0</span> &amp;&amp; date &gt; <span class=number>7</span>) &#123;</div><div class=line>                _m[i] = &#123;</div><div class=line>                    isCurMonth: <span class=literal>false</span>,</div><div class=line>                    dateNum: date,</div><div class=line>                    weekIndex,</div><div class=line>                    date: <span class=string>`<span class=subst>$&#123;y - <span class=number>1</span>&#125;</span>/<span class=subst>$&#123;<span class=number>12</span>&#125;</span>/<span class=subst>$&#123;date&#125;</span>`</span></div><div class=line>                &#125;;</div><div class=line>            &#125; <span class=keyword>else</span> &#123;</div><div class=line>                _m[i] = &#123;</div><div class=line>                    isCurMonth: <span class=literal>false</span>,</div><div class=line>                    dateNum: date,</div><div class=line>                    weekIndex,</div><div class=line>                    date: <span class=string>`<span class=subst>$&#123;y&#125;</span>/<span class=subst>$&#123;m&#125;</span>/<span class=subst>$&#123;date&#125;</span>`</span></div><div class=line>                &#125;;</div><div class=line>            &#125;</div><div class=line>        &#125; <span class=keyword>else</span> <span class=keyword>if</span> (i &gt;= (firstDay + days)) &#123;</div><div class=line>            <span class=keyword>let</span> date = ++nextMonthDay;</div><div class=line></div><div class=line>            <span class=keyword>if</span> (m === <span class=number>11</span> &amp;&amp; date &lt;= <span class=number>7</span>) &#123;</div><div class=line>                _m[i] = &#123;</div><div class=line>                    isCurMonth: <span class=literal>false</span>,</div><div class=line>                    dateNum: date,</div><div class=line>                    weekIndex,</div><div class=line>                    date: <span class=string>`<span class=subst>$&#123;y + <span class=number>1</span>&#125;</span>/<span class=subst>$&#123;<span class=number>1</span>&#125;</span>/<span class=subst>$&#123;date&#125;</span>`</span></div><div class=line>                &#125;;</div><div class=line>            &#125; <span class=keyword>else</span> &#123;</div><div class=line>                _m[i] = &#123;</div><div class=line>                    isCurMonth: <span class=literal>false</span>,</div><div class=line>                    dateNum: date,</div><div class=line>                    weekIndex,</div><div class=line>                    date: <span class=string>`<span class=subst>$&#123;y&#125;</span>/<span class=subst>$&#123;m + <span class=number>2</span>&#125;</span>/<span class=subst>$&#123;date&#125;</span>`</span></div><div class=line>                &#125;;</div><div class=line>            &#125;</div><div class=line>        &#125; <span class=keyword>else</span> &#123;</div><div class=line>            <span class=keyword>let</span> _date = i - firstDay + <span class=number>1</span>;</div><div class=line>            <span class=keyword>let</span> today = <span class=keyword>new</span> <span class=built_in>Date</span>();</div><div class=line>            <span class=keyword>let</span> today_y = today.getFullYear();</div><div class=line>            <span class=keyword>let</span> today_m = today.getMonth();</div><div class=line>            <span class=keyword>let</span> today_d = today.getDate();</div><div class=line>            <span class=keyword>let</span> isToday = today_y === y &amp;&amp; today_m === m &amp;&amp; today_d === _date ? <span class=literal>true</span> : <span class=literal>false</span>;</div><div class=line>            _m[i] = &#123;</div><div class=line>                dateNum: _date, <span class=comment>//日期</span></div><div class=line>                day: i % <span class=number>7</span>, <span class=comment>//周期</span></div><div class=line>                weekIndex,</div><div class=line>                isCurMonth: <span class=literal>true</span>,</div><div class=line>                isToday,</div><div class=line>                date: <span class=string>`<span class=subst>$&#123;y&#125;</span>/<span class=subst>$&#123;m + <span class=number>1</span>&#125;</span>/<span class=subst>$&#123;_date&#125;</span>`</span></div><div class=line>            &#125;;</div><div class=line>        &#125;</div><div class=line>    &#125;</div><div class=line>    <span class=keyword>return</span> _m;</div><div class=line>&#125;</div></pre></td></tr></table></figure><h3 id=getOneDateWeekIndex><a href=#getOneDateWeekIndex class=headerlink title=getOneDateWeekIndex></a>getOneDateWeekIndex</h3><figure class="highlight javascript"><table><tr><td class=gutter><pre><div class=line>1</div><div class=line>2</div><div class=line>3</div><div class=line>4</div><div class=line>5</div><div class=line>6</div><div class=line>7</div><div class=line>8</div><div class=line>9</div><div class=line>10</div><div class=line>11</div><div class=line>12</div><div class=line>13</div><div class=line>14</div><div class=line>15</div></pre></td><td class=code><pre><div class=line><span class=comment>/**</span></div><div class=line><span class=comment> * [getOneDateWeekIndex 获得指定的某天所在该月的第几周，下标从0开始]</span></div><div class=line><span class=comment> * @param  &#123;[Date]&#125; date [指定的日期，非必填，默认为当天]</span></div><div class=line><span class=comment> * @return &#123;[Int]&#125;      [在该月的第几周]</span></div><div class=line><span class=comment> */</span></div><div class=line><span class=keyword>export</span> <span class=function><span class=keyword>function</span> <span class=title>getOneDateWeekIndex</span>(<span class=params>date</span>) </span>&#123;</div><div class=line>    date = date ? date : <span class=keyword>new</span> <span class=built_in>Date</span>();</div><div class=line>    <span class=keyword>let</span> monthDays = getCalendarMonth(date);</div><div class=line>    <span class=keyword>let</span> dateString = getFormatDateStr(date, <span class=string>'/'</span>, <span class=literal>true</span>, <span class=literal>false</span>, <span class=literal>false</span>);</div><div class=line>    <span class=keyword>let</span> returnDate = monthDays.filter(<span class=function><span class=params>item</span> =&gt;</span> &#123;</div><div class=line>        <span class=keyword>return</span> item.date === dateString;</div><div class=line>    &#125;);</div><div class=line>    <span class=keyword>let</span> weekIndex = returnDate[<span class=number>0</span>].weekIndex;</div><div class=line>    <span class=keyword>return</span> weekIndex ? weekIndex : <span class=number>0</span>;</div><div class=line>&#125;</div></pre></td></tr></table></figure></div><div id=side-right-bar><div class=close-right-bar></div><div class=sidebar-toc><div class=sidebar-toc__title>目录</div><div class=sidebar-toc__progress><span class=progress-notice>你已经阅读了</span><span class=progress-num>0</span><span class=progress-percentage>%</span><div class=sidebar-toc__progress-bar></div></div><div class=sidebar-toc__content><ol class=toc><li class="toc-item toc-level-3"><a class=toc-link href=#getFormatDateStr><span class=toc-number>1.</span> <span class=toc-text>getFormatDateStr</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#getDayPrevAfter><span class=toc-number>2.</span> <span class=toc-text>getDayPrevAfter</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#formatDateWithTimeZone><span class=toc-number>3.</span> <span class=toc-text>formatDateWithTimeZone</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#countDownBySecond><span class=toc-number>4.</span> <span class=toc-text>countDownBySecond</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#monthSize><span class=toc-number>5.</span> <span class=toc-text>monthSize</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#getCalendarMonth><span class=toc-number>6.</span> <span class=toc-text>getCalendarMonth</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#getOneDateWeekIndex><span class=toc-number>7.</span> <span class=toc-text>getOneDateWeekIndex</span></a></li></ol></div></div></div><div class=right-btn id=right-btn><span>目录</span></div><div class=article-bottom><div class="addthis_inline_share_toolbox fr"></div></div><div class=post-copyright><div class=post-copyright__author><span class=post-copyright-meta>文章作者:</span><span class=post-copyright-info><a href=mailto:undefined>CavinHuang</a></span></div><div class=post-copyright__type><span class=post-copyright-meta>文章链接:</span><span class=post-copyright-info><a href="http://blog.zukmb.cnjavascript日期操作函数/">http://blog.zukmb.cnjavascript日期操作函数/</a></span></div><div class=post-copyright__notice><span class=post-copyright-meta>版权声明:</span><span class=post-copyright-info>转载请注明来自<a href=http://blog.zukmb.cn target=_blank style="font-size: 18px;">CavinHuangのBlog</a>！</span></div></div><div class=article-pagenate><div class="article-prev fl"><span>←</span><a href="/js常用代码整理/">js常用代码整理</a></div><div class="article-next fr"><a href="/设备检测/">设备检测</a><span>→</span></div></div></article></div><footer class=footer><div id=toTop style="display: none;">Back to Top</div></footer></div></div><canvas class=fireworks></canvas><script src=/js/velocity.ui.min.js></script><script src=/js/yoyo.js></script><script src=/js/scroll.js></script><script src=/js/particle.js></script><script src=/js/anime.min.js></script><script src=/js/fireworks.js></script>