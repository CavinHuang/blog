<!DOCTYPE html><html lang=zh><head><meta charset=UTF-8><meta name=baidu-site-verification content=rqskM4bdtP><meta name=viewport content="device-width, initial-scale=1, maximum-scale=1,user-scalable=no"><title>给vue配置axios包括报错,鉴权,跳转,拦截,提示的封装-CavinHuang-不懂写故事的猫-http://blog.zukmb.cn</title><meta name=keywords content=前端学习,php学习,个人博客,HTML,CSS,JS><meta name=description content=cavinHuang个人博客，这里记录学习和生活的点滴！><meta name=google-site-verification content=zOYxWUgmeogC0qY76WLP0eWl8r9E8jk_qU927Ij7tbs><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5a4c3745fa28006f"></script><link rel=stylesheet href=/css/yoyo.css><link rel=icon href=/img/favicon.png><link rel=stylesheet href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css?version=1.3"><script src=//cdn.bootcss.com/jquery/3.2.1/jquery.min.js></script><script src=//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js></script><script src=https://cdn.bootcss.com/velocity/1.5.0/velocity.min.js></script></head><body></body></html><div class=app><div class=left-container><canvas id=cas></canvas><div class="left-layout-container pc"><div class=user-info><a href="/"><img src="https://avatars1.githubusercontent.com/u/24950299?s=460&amp;v=4"></a><div class=login-name>CavinHuang</div><div class=slog>来不及总结自己,愿天大地大,我独一无二!</div></div><ul class=other-site><li><img src=http://www.17sucai.com/preview/177065/2017-09-28/Mon9/static/img/github.png></li><li><img src=http://www.17sucai.com/preview/177065/2017-09-28/Mon9/static/img/weibo.png></li></ul><ul class=left-menu><li><a href=/archives>文章</a></li><li><a href=/categories>分类</a></li><li><a href=/tags>标签</a></li><li><a href=/about>关于</a></li></ul><div class=qq-group><span>读万卷书</span><span>行万里路</span></div><div class=copyright>@ 2017 - 2017 CavinHuang</div></div></div><div class="blog-container main-container" id=content-outer><div class=blog-list-container id=content-inner><article class=article-container id=post><div class=article-header><h1 class=article-title>给vue配置axios包括报错,鉴权,跳转,拦截,提示的封装</h1><div class=article-subtitle><div class="publish-time fl">发布时间:<span>2018/2/27 20:53:9</span></div><div class=categories>分类:<a href="/categories/前端开发/"><span>前端开发</span></a></div></div></div><div class=article-content><h1 id=前言><a href=#前言 class=headerlink title=前言></a>前言</h1><p>不推荐完全copy过去,可以看看我是如何针对我这边业务;<br>做的一个axios的封装及实现的思路<br><a id=more></a></p><h1 id=需求及实现><a href=#需求及实现 class=headerlink title=需求及实现></a>需求及实现</h1><ul><li>统一捕获接口报错</li><li>弹窗提示</li><li>报错重定向</li><li>基础鉴权</li><li>表单序列化</li></ul><p>#实现的功能</p><ul><li>统一捕获接口报错 : 用的axios内置的拦截器</li><li>弹窗提示: 引入 Element UI的Message组件</li><li>报错重定向: 路由钩子</li><li>基础鉴权: 服务端过期时间戳和token,还有借助路由的钩子</li><li>表单序列化: 我这边直接用qs(npm模块),你有时间也可以自己写<br>用法及封装<br>用法<figure class="highlight js"><table><tr><td class=gutter><pre><div class=line>1</div><div class=line>2</div><div class=line>3</div><div class=line>4</div></pre></td><td class=code><pre><div class=line><span class=comment>// 服务层 , import默认会找该目录下index.js的文件,这个可能有小伙伴不知道</span></div><div class=line><span class=comment>// 可以去了解npm的引入和es6引入的理论概念</span></div><div class=line><span class=keyword>import</span> axiosPlugin <span class=keyword>from</span> <span class=string>"./server"</span>;</div><div class=line>Vue.use(axiosPlugin);</div></pre></td></tr></table></figure></li></ul><p>对axios的封装(AXIOS:index.js)<br><figure class="highlight js"><table><tr><td class=gutter><pre><div class=line>1</div><div class=line>2</div><div class=line>3</div><div class=line>4</div><div class=line>5</div><div class=line>6</div><div class=line>7</div><div class=line>8</div><div class=line>9</div><div class=line>10</div><div class=line>11</div><div class=line>12</div><div class=line>13</div><div class=line>14</div><div class=line>15</div><div class=line>16</div><div class=line>17</div><div class=line>18</div><div class=line>19</div><div class=line>20</div><div class=line>21</div><div class=line>22</div><div class=line>23</div><div class=line>24</div><div class=line>25</div><div class=line>26</div><div class=line>27</div><div class=line>28</div><div class=line>29</div><div class=line>30</div><div class=line>31</div><div class=line>32</div><div class=line>33</div><div class=line>34</div><div class=line>35</div><div class=line>36</div><div class=line>37</div><div class=line>38</div><div class=line>39</div><div class=line>40</div><div class=line>41</div><div class=line>42</div><div class=line>43</div><div class=line>44</div><div class=line>45</div><div class=line>46</div><div class=line>47</div><div class=line>48</div><div class=line>49</div><div class=line>50</div><div class=line>51</div><div class=line>52</div><div class=line>53</div><div class=line>54</div><div class=line>55</div><div class=line>56</div><div class=line>57</div><div class=line>58</div><div class=line>59</div><div class=line>60</div><div class=line>61</div><div class=line>62</div><div class=line>63</div><div class=line>64</div><div class=line>65</div><div class=line>66</div><div class=line>67</div><div class=line>68</div><div class=line>69</div><div class=line>70</div><div class=line>71</div><div class=line>72</div><div class=line>73</div><div class=line>74</div><div class=line>75</div><div class=line>76</div><div class=line>77</div><div class=line>78</div><div class=line>79</div><div class=line>80</div><div class=line>81</div><div class=line>82</div><div class=line>83</div><div class=line>84</div><div class=line>85</div><div class=line>86</div><div class=line>87</div><div class=line>88</div><div class=line>89</div><div class=line>90</div><div class=line>91</div><div class=line>92</div><div class=line>93</div><div class=line>94</div><div class=line>95</div><div class=line>96</div><div class=line>97</div><div class=line>98</div><div class=line>99</div><div class=line>100</div><div class=line>101</div><div class=line>102</div><div class=line>103</div><div class=line>104</div><div class=line>105</div><div class=line>106</div><div class=line>107</div><div class=line>108</div><div class=line>109</div><div class=line>110</div><div class=line>111</div><div class=line>112</div><div class=line>113</div><div class=line>114</div><div class=line>115</div><div class=line>116</div><div class=line>117</div><div class=line>118</div><div class=line>119</div><div class=line>120</div><div class=line>121</div><div class=line>122</div><div class=line>123</div><div class=line>124</div></pre></td><td class=code><pre><div class=line><span class=keyword>import</span> axios <span class=keyword>from</span> <span class=string>"axios"</span>;</div><div class=line><span class=keyword>import</span> qs <span class=keyword>from</span> <span class=string>"qs"</span>;</div><div class=line><span class=keyword>import</span> &#123; Message &#125; <span class=keyword>from</span> <span class=string>"element-ui"</span>;</div><div class=line><span class=keyword>import</span> router <span class=keyword>from</span> <span class=string>"../router"</span>;</div><div class=line></div><div class=line><span class=keyword>const</span> Axios = axios.create(&#123;</div><div class=line>  baseURL: <span class=string>"/"</span>, <span class=comment>// 因为我本地做了反向代理</span></div><div class=line>  timeout: <span class=number>10000</span>,</div><div class=line>  responseType: <span class=string>"json"</span>,</div><div class=line>  withCredentials: <span class=literal>true</span>, <span class=comment>// 是否允许带cookie这些</span></div><div class=line>  headers: &#123;</div><div class=line>    <span class=string>"Content-Type"</span>: <span class=string>"application/x-www-form-urlencoded;charset=utf-8"</span></div><div class=line>  &#125;</div><div class=line>&#125;);</div><div class=line></div><div class=line><span class=comment>//POST传参序列化(添加请求拦截器)</span></div><div class=line>Axios.interceptors.request.use(</div><div class=line>  config =&gt; &#123;</div><div class=line>    <span class=comment>// 在发送请求之前做某件事</span></div><div class=line>    <span class=keyword>if</span> (</div><div class=line>      config.method === <span class=string>"post"</span> ||</div><div class=line>      config.method === <span class=string>"put"</span> ||</div><div class=line>      config.method === <span class=string>"delete"</span></div><div class=line>    ) &#123;</div><div class=line>      <span class=comment>// 序列化</span></div><div class=line>      config.data = qs.stringify(config.data);</div><div class=line>    &#125;</div><div class=line></div><div class=line>    <span class=comment>// 若是有做鉴权token , 就给头部带上token</span></div><div class=line>    <span class=keyword>if</span> (localStorage.token) &#123;</div><div class=line>      config.headers.Authorization = localStorage.token;</div><div class=line>    &#125;</div><div class=line>    <span class=keyword>return</span> config;</div><div class=line>  &#125;,</div><div class=line>  error =&gt; &#123;</div><div class=line>    Message(&#123;</div><div class=line>      <span class=comment>//  饿了么的消息弹窗组件,类似toast</span></div><div class=line>      showClose: <span class=literal>true</span>,</div><div class=line>      message: error,</div><div class=line>      type: <span class=string>"error.data.error.message"</span></div><div class=line>    &#125;);</div><div class=line>    <span class=keyword>return</span> <span class=built_in>Promise</span>.reject(error.data.error.message);</div><div class=line>  &#125;</div><div class=line>);</div><div class=line></div><div class=line><span class=comment>//返回状态判断(添加响应拦截器)</span></div><div class=line>Axios.interceptors.response.use(</div><div class=line>  res =&gt; &#123;</div><div class=line>    <span class=comment>//对响应数据做些事</span></div><div class=line>    <span class=keyword>if</span> (res.data &amp;&amp; !res.data.success) &#123;</div><div class=line>      Message(&#123;</div><div class=line>        <span class=comment>//  饿了么的消息弹窗组件,类似toast</span></div><div class=line>        showClose: <span class=literal>true</span>,</div><div class=line>        message: res.data.error.message.message</div><div class=line>          ? res.data.error.message.message</div><div class=line>          : res.data.error.message,</div><div class=line>        type: <span class=string>"error"</span></div><div class=line>      &#125;);</div><div class=line>      <span class=keyword>return</span> <span class=built_in>Promise</span>.reject(res.data.error.message);</div><div class=line>    &#125;</div><div class=line>    <span class=keyword>return</span> res;</div><div class=line>  &#125;,</div><div class=line>  error =&gt; &#123;</div><div class=line>    <span class=comment>// 用户登录的时候会拿到一个基础信息,比如用户名,token,过期时间戳</span></div><div class=line>    <span class=comment>// 直接丢localStorage或者sessionStorage</span></div><div class=line>    <span class=keyword>if</span> (!<span class=built_in>window</span>.localStorage.getItem(<span class=string>"loginUserBaseInfo"</span>)) &#123;</div><div class=line>      <span class=comment>// 若是接口访问的时候没有发现有鉴权的基础信息,直接返回登录页</span></div><div class=line>      router.push(&#123;</div><div class=line>        path: <span class=string>"/login"</span></div><div class=line>      &#125;);</div><div class=line>    &#125; <span class=keyword>else</span> &#123;</div><div class=line>      <span class=comment>// 若是有基础信息的情况下,判断时间戳和当前的时间,若是当前的时间大于服务器过期的时间</span></div><div class=line>      <span class=comment>// 乖乖的返回去登录页重新登录</span></div><div class=line>      <span class=keyword>let</span> lifeTime =</div><div class=line>        <span class=built_in>JSON</span>.parse(<span class=built_in>window</span>.localStorage.getItem(<span class=string>"loginUserBaseInfo"</span>)).lifeTime *</div><div class=line>        <span class=number>1000</span>;</div><div class=line>      <span class=keyword>let</span> nowTime = <span class=keyword>new</span> <span class=built_in>Date</span>().getTime(); <span class=comment>// 当前时间的时间戳</span></div><div class=line>      <span class=built_in>console</span>.log(nowTime, lifeTime);</div><div class=line>      <span class=built_in>console</span>.log(nowTime &gt; lifeTime);</div><div class=line>      <span class=keyword>if</span> (nowTime &gt; lifeTime) &#123;</div><div class=line>        Message(&#123;</div><div class=line>          showClose: <span class=literal>true</span>,</div><div class=line>          message: <span class=string>"登录状态信息过期,请重新登录"</span>,</div><div class=line>          type: <span class=string>"error"</span></div><div class=line>        &#125;);</div><div class=line>        router.push(&#123;</div><div class=line>          path: <span class=string>"/login"</span></div><div class=line>        &#125;);</div><div class=line>      &#125; <span class=keyword>else</span> &#123;</div><div class=line>        <span class=comment>// 下面是接口回调的satus ,因为我做了一些错误页面,所以都会指向对应的报错页面</span></div><div class=line>        <span class=keyword>if</span> (error.response.status === <span class=number>403</span>) &#123;</div><div class=line>          router.push(&#123;</div><div class=line>            path: <span class=string>"/error/403"</span></div><div class=line>          &#125;);</div><div class=line>        &#125;</div><div class=line>        <span class=keyword>if</span> (error.response.status === <span class=number>500</span>) &#123;</div><div class=line>          router.push(&#123;</div><div class=line>            path: <span class=string>"/error/500"</span></div><div class=line>          &#125;);</div><div class=line>        &#125;</div><div class=line>        <span class=keyword>if</span> (error.response.status === <span class=number>502</span>) &#123;</div><div class=line>          router.push(&#123;</div><div class=line>            path: <span class=string>"/error/502"</span></div><div class=line>          &#125;);</div><div class=line>        &#125;</div><div class=line>        <span class=keyword>if</span> (error.response.status === <span class=number>404</span>) &#123;</div><div class=line>          router.push(&#123;</div><div class=line>            path: <span class=string>"/error/404"</span></div><div class=line>          &#125;);</div><div class=line>        &#125;</div><div class=line>      &#125;</div><div class=line>    &#125;</div><div class=line>    <span class=comment>// 返回 response 里的错误信息</span></div><div class=line>    <span class=keyword>let</span> errorInfo =  error.data.error ? error.data.error.message : error.data;</div><div class=line>    <span class=keyword>return</span> <span class=built_in>Promise</span>.reject(errorInfo);</div><div class=line>  &#125;</div><div class=line>);</div><div class=line></div><div class=line><span class=comment>// 对axios的实例重新封装成一个plugin ,方便 Vue.use(xxxx)</span></div><div class=line><span class=keyword>export</span> <span class=keyword>default</span> &#123;</div><div class=line>  install: <span class=function><span class=keyword>function</span>(<span class=params>Vue, Option</span>) </span>&#123;</div><div class=line>    <span class=built_in>Object</span>.defineProperty(Vue.prototype, <span class=string>"$http"</span>, &#123; <span class=attr>value</span>: Axios &#125;);</div><div class=line>  &#125;</div><div class=line>&#125;;</div></pre></td></tr></table></figure></p><p>路由钩子的调整(Router:index.js)</p><figure class="highlight js"><table><tr><td class=gutter><pre><div class=line>1</div><div class=line>2</div><div class=line>3</div><div class=line>4</div><div class=line>5</div><div class=line>6</div><div class=line>7</div><div class=line>8</div><div class=line>9</div><div class=line>10</div><div class=line>11</div><div class=line>12</div><div class=line>13</div><div class=line>14</div><div class=line>15</div><div class=line>16</div><div class=line>17</div><div class=line>18</div><div class=line>19</div><div class=line>20</div><div class=line>21</div><div class=line>22</div><div class=line>23</div><div class=line>24</div><div class=line>25</div><div class=line>26</div><div class=line>27</div><div class=line>28</div><div class=line>29</div><div class=line>30</div><div class=line>31</div><div class=line>32</div><div class=line>33</div><div class=line>34</div><div class=line>35</div><div class=line>36</div><div class=line>37</div><div class=line>38</div><div class=line>39</div><div class=line>40</div><div class=line>41</div><div class=line>42</div><div class=line>43</div><div class=line>44</div><div class=line>45</div><div class=line>46</div><div class=line>47</div><div class=line>48</div><div class=line>49</div><div class=line>50</div><div class=line>51</div><div class=line>52</div><div class=line>53</div><div class=line>54</div><div class=line>55</div><div class=line>56</div><div class=line>57</div><div class=line>58</div><div class=line>59</div><div class=line>60</div><div class=line>61</div><div class=line>62</div><div class=line>63</div><div class=line>64</div><div class=line>65</div><div class=line>66</div><div class=line>67</div><div class=line>68</div><div class=line>69</div><div class=line>70</div><div class=line>71</div><div class=line>72</div><div class=line>73</div><div class=line>74</div><div class=line>75</div><div class=line>76</div></pre></td><td class=code><pre><div class=line><span class=keyword>import</span> Vue <span class=keyword>from</span> <span class=string>"vue"</span>;</div><div class=line><span class=keyword>import</span> Router <span class=keyword>from</span> <span class=string>"vue-router"</span>;</div><div class=line><span class=keyword>import</span> layout <span class=keyword>from</span> <span class=string>"@/components/layout/layout"</span>;</div><div class=line><span class=comment>// 版块有点多,版块独立路由管理,里面都是懒加载引入</span></div><div class=line><span class=keyword>import</span> customerManage <span class=keyword>from</span> <span class=string>"./customerManage"</span>; <span class=comment>// 客户管理</span></div><div class=line><span class=keyword>import</span> account <span class=keyword>from</span> <span class=string>"./account"</span>; <span class=comment>//登录</span></div><div class=line><span class=keyword>import</span> adManage <span class=keyword>from</span> <span class=string>"./adManage"</span>; <span class=comment>// 广告管理</span></div><div class=line><span class=keyword>import</span> dataStat <span class=keyword>from</span> <span class=string>"./dataStat"</span>; <span class=comment>// 数据统计</span></div><div class=line><span class=keyword>import</span> logger <span class=keyword>from</span> <span class=string>"./logger"</span>; <span class=comment>// 日志</span></div><div class=line><span class=keyword>import</span> manager <span class=keyword>from</span> <span class=string>"./manager"</span>; <span class=comment>// 管理者</span></div><div class=line><span class=keyword>import</span> putonManage <span class=keyword>from</span> <span class=string>"./putonManage"</span>; <span class=comment>// 投放管理</span></div><div class=line><span class=keyword>import</span> error <span class=keyword>from</span> <span class=string>"./error"</span>; <span class=comment>// 服务端错误</span></div><div class=line><span class=keyword>import</span> &#123; Message &#125; <span class=keyword>from</span> <span class=string>"element-ui"</span>;</div><div class=line></div><div class=line>Vue.use(Router);</div><div class=line></div><div class=line><span class=comment>// 请跳过这一段,看下面的</span></div><div class=line><span class=keyword>const</span> router = <span class=keyword>new</span> Router(&#123;</div><div class=line>  hashbang: <span class=literal>false</span>,</div><div class=line>  mode: <span class=string>"history"</span>,</div><div class=line>  routes: [</div><div class=line>    &#123;</div><div class=line>      path: <span class=string>"/"</span>,</div><div class=line>      redirect: <span class=string>"/adver"</span>,</div><div class=line>      component: layout,</div><div class=line>      children: [</div><div class=line>        ...customerManage,</div><div class=line>        ...adManage,</div><div class=line>        ...dataStat,</div><div class=line>        ...putonManage,</div><div class=line>        ...manager,</div><div class=line>        ...logger</div><div class=line>      ]</div><div class=line>    &#125;,</div><div class=line>    ...account,</div><div class=line>    ...error</div><div class=line>  ]</div><div class=line>&#125;);</div><div class=line></div><div class=line><span class=comment>// 路由拦截</span></div><div class=line><span class=comment>// 差点忘了说明,不是所有版块都需要鉴权的</span></div><div class=line><span class=comment>// 所以需要鉴权,我都会在路由meta添加添加一个字段requireLogin,设置为true的时候</span></div><div class=line><span class=comment>// 这货就必须走鉴权,像登录页这些不要,是可以直接访问的!!!</span></div><div class=line>router.beforeEach(<span class=function>(<span class=params>to, <span class=keyword>from</span>, next</span>) =&gt;</span> &#123;</div><div class=line>  <span class=keyword>if</span> (to.matched.some(<span class=function><span class=params>res</span> =&gt;</span> res.meta.requireLogin)) &#123;</div><div class=line>    <span class=comment>// 判断是否需要登录权限</span></div><div class=line>    <span class=keyword>if</span> (<span class=built_in>window</span>.localStorage.getItem(<span class=string>"loginUserBaseInfo"</span>)) &#123;</div><div class=line>      <span class=comment>// 判断是否登录</span></div><div class=line>      <span class=keyword>let</span> lifeTime =</div><div class=line>        <span class=built_in>JSON</span>.parse(<span class=built_in>window</span>.localStorage.getItem(<span class=string>"loginUserBaseInfo"</span>)).lifeTime *</div><div class=line>        <span class=number>1000</span>;</div><div class=line>      <span class=keyword>let</span> nowTime = (<span class=keyword>new</span> <span class=built_in>Date</span>()).getTime(); <span class=comment>// 当前时间的时间戳</span></div><div class=line>      <span class=keyword>if</span> (nowTime &lt; lifeTime) &#123;</div><div class=line>        next();</div><div class=line>      &#125; <span class=keyword>else</span> &#123;</div><div class=line>        Message(&#123;</div><div class=line>          showClose: <span class=literal>true</span>,</div><div class=line>          message: <span class=string>"登录状态信息过期,请重新登录"</span>,</div><div class=line>          type: <span class=string>"error"</span></div><div class=line>        &#125;);</div><div class=line>        next(&#123;</div><div class=line>          path: <span class=string>"/login"</span></div><div class=line>        &#125;);</div><div class=line>      &#125;</div><div class=line>    &#125; <span class=keyword>else</span> &#123;</div><div class=line>      <span class=comment>// 没登录则跳转到登录界面</span></div><div class=line>      next(&#123;</div><div class=line>        path: <span class=string>"/login"</span></div><div class=line>      &#125;);</div><div class=line>    &#125;</div><div class=line>  &#125; <span class=keyword>else</span> &#123;</div><div class=line>    next();</div><div class=line>  &#125;</div><div class=line>&#125;);</div><div class=line></div><div class=line><span class=keyword>export</span> <span class=keyword>default</span> router;</div></pre></td></tr></table></figure><p>axios可配置的一些选项,其他的具体看官网说明哈</p><figure class="highlight js"><table><tr><td class=gutter><pre><div class=line>1</div><div class=line>2</div><div class=line>3</div><div class=line>4</div><div class=line>5</div><div class=line>6</div><div class=line>7</div><div class=line>8</div><div class=line>9</div><div class=line>10</div><div class=line>11</div><div class=line>12</div><div class=line>13</div><div class=line>14</div><div class=line>15</div><div class=line>16</div><div class=line>17</div><div class=line>18</div><div class=line>19</div><div class=line>20</div><div class=line>21</div><div class=line>22</div><div class=line>23</div><div class=line>24</div><div class=line>25</div><div class=line>26</div><div class=line>27</div><div class=line>28</div><div class=line>29</div><div class=line>30</div><div class=line>31</div><div class=line>32</div><div class=line>33</div><div class=line>34</div><div class=line>35</div><div class=line>36</div><div class=line>37</div><div class=line>38</div><div class=line>39</div><div class=line>40</div><div class=line>41</div><div class=line>42</div><div class=line>43</div><div class=line>44</div><div class=line>45</div><div class=line>46</div><div class=line>47</div><div class=line>48</div><div class=line>49</div><div class=line>50</div><div class=line>51</div><div class=line>52</div><div class=line>53</div><div class=line>54</div><div class=line>55</div><div class=line>56</div><div class=line>57</div><div class=line>58</div><div class=line>59</div><div class=line>60</div><div class=line>61</div><div class=line>62</div><div class=line>63</div></pre></td><td class=code><pre><div class=line><span class=keyword>export</span> <span class=keyword>default</span> &#123;</div><div class=line>  <span class=comment>// 请求地址</span></div><div class=line>  url: <span class=string>"/user"</span>,</div><div class=line>  <span class=comment>// 请求类型</span></div><div class=line>  method: <span class=string>"get"</span>,</div><div class=line>  <span class=comment>// 请根路径</span></div><div class=line>  baseURL: <span class=string>"http://www.mt.com/api"</span>,</div><div class=line>  <span class=comment>// 请求前的数据处理</span></div><div class=line>  transformRequest: [<span class=function><span class=keyword>function</span>(<span class=params>data</span>) </span>&#123;&#125;],</div><div class=line>  <span class=comment>// 请求后的数据处理</span></div><div class=line>  transformResponse: [<span class=function><span class=keyword>function</span>(<span class=params>data</span>) </span>&#123;&#125;],</div><div class=line>  <span class=comment>// 自定义的请求头</span></div><div class=line>  headers: &#123; <span class=string>"x-Requested-With"</span>: <span class=string>"XMLHttpRequest"</span> &#125;,</div><div class=line>  <span class=comment>// URL查询对象</span></div><div class=line>  params: &#123; <span class=attr>id</span>: <span class=number>12</span> &#125;,</div><div class=line>  <span class=comment>// 查询对象序列化函数</span></div><div class=line>  paramsSerializer: <span class=function><span class=keyword>function</span>(<span class=params>params</span>) </span>&#123;&#125;,</div><div class=line>  <span class=comment>// request body</span></div><div class=line>  data: &#123; <span class=attr>key</span>: <span class=string>"aa"</span> &#125;,</div><div class=line>  <span class=comment>// 超时设置s</span></div><div class=line>  timeout: <span class=number>1000</span>,</div><div class=line>  <span class=comment>// 跨域是否带Token</span></div><div class=line>  withCredentials: <span class=literal>false</span>,</div><div class=line>  <span class=comment>// 自定义请求处理</span></div><div class=line>  adapter: <span class=function><span class=keyword>function</span>(<span class=params>resolve, reject, config</span>) </span>&#123;&#125;,</div><div class=line>  <span class=comment>// 身份验证信息</span></div><div class=line>  auth: &#123; <span class=attr>uname</span>: <span class=string>""</span>, <span class=attr>pwd</span>: <span class=string>"12"</span> &#125;,</div><div class=line>  <span class=comment>// 响应的数据格式 json / blob /document /arraybuffer / text / stream</span></div><div class=line>  responseType: <span class=string>"json"</span>,</div><div class=line>  <span class=comment>// xsrf 设置</span></div><div class=line>  xsrfCookieName: <span class=string>"XSRF-TOKEN"</span>,</div><div class=line>  xsrfHeaderName: <span class=string>"X-XSRF-TOKEN"</span>,</div><div class=line></div><div class=line>  <span class=comment>// 下传和下载进度回调</span></div><div class=line>  onUploadProgress: <span class=function><span class=keyword>function</span>(<span class=params>progressEvent</span>) </span>&#123;</div><div class=line>    <span class=built_in>Math</span>.round(progressEvent.loaded * <span class=number>100</span> / progressEvent.total);</div><div class=line>  &#125;,</div><div class=line>  onDownloadProgress: <span class=function><span class=keyword>function</span>(<span class=params>progressEvent</span>) </span>&#123;&#125;,</div><div class=line></div><div class=line>  <span class=comment>// 最多转发数，用于node.js</span></div><div class=line>  maxRedirects: <span class=number>5</span>,</div><div class=line>  <span class=comment>// 最大响应数据大小</span></div><div class=line>  maxContentLength: <span class=number>2000</span>,</div><div class=line>  <span class=comment>// 自定义错误状态码范围</span></div><div class=line>  validateStatus: <span class=function><span class=keyword>function</span>(<span class=params>status</span>) </span>&#123;</div><div class=line>    <span class=keyword>return</span> status &gt;= <span class=number>200</span> &amp;&amp; status &lt; <span class=number>300</span>;</div><div class=line>  &#125;,</div><div class=line>  <span class=comment>// 用于node.js</span></div><div class=line>  httpAgent: <span class=keyword>new</span> http.Agent(&#123; <span class=attr>keepAlive</span>: <span class=literal>true</span> &#125;),</div><div class=line>  httpsAgent: <span class=keyword>new</span> https.Agent(&#123; <span class=attr>keepAlive</span>: <span class=literal>true</span> &#125;),</div><div class=line></div><div class=line>  <span class=comment>// 用于设置跨域请求代理</span></div><div class=line>  proxy: &#123;</div><div class=line>    host: <span class=string>"127.0.0.1"</span>,</div><div class=line>    port: <span class=number>8080</span>,</div><div class=line>    auth: &#123;</div><div class=line>      username: <span class=string>"aa"</span>,</div><div class=line>      password: <span class=string>"2123"</span></div><div class=line>    &#125;</div><div class=line>  &#125;,</div><div class=line>  <span class=comment>// 用于取消请求</span></div><div class=line>  cancelToken: <span class=keyword>new</span> CancelToken(<span class=function><span class=keyword>function</span>(<span class=params>cancel</span>) </span>&#123;&#125;)</div><div class=line>&#125;;</div></pre></td></tr></table></figure><p>总结<br>我这个封装虽说不是万金油版本,但是我感觉大多用axios结合vue的小伙伴,<br>稍微改改都能直接拿来用~~~哟吼吼,哟吼吼…..</p></div><div id=side-right-bar><div class=close-right-bar></div><div class=sidebar-toc><div class=sidebar-toc__title>目录</div><div class=sidebar-toc__progress><span class=progress-notice>你已经阅读了</span><span class=progress-num>0</span><span class=progress-percentage>%</span><div class=sidebar-toc__progress-bar></div></div><div class=sidebar-toc__content><ol class=toc><li class="toc-item toc-level-1"><a class=toc-link href=#前言><span class=toc-number>1.</span> <span class=toc-text>前言</span></a></li><li class="toc-item toc-level-1"><a class=toc-link href=#需求及实现><span class=toc-number>2.</span> <span class=toc-text>需求及实现</span></a></li></ol></div></div></div><div class=right-btn id=right-btn><span>目录</span></div><div class=article-bottom><div class="addthis_inline_share_toolbox fr"></div></div><div class=post-copyright><div class=post-copyright__author><span class=post-copyright-meta>文章作者:</span><span class=post-copyright-info><a href=mailto:undefined>CavinHuang</a></span></div><div class=post-copyright__type><span class=post-copyright-meta>文章链接:</span><span class=post-copyright-info><a href="http://blog.zukmb.cn给vue配置axios包括报错-鉴权-跳转-拦截-提示的封装/">http://blog.zukmb.cn给vue配置axios包括报错-鉴权-跳转-拦截-提示的封装/</a></span></div><div class=post-copyright__notice><span class=post-copyright-meta>版权声明:</span><span class=post-copyright-info>转载请注明来自<a href=http://blog.zukmb.cn target=_blank style="font-size: 18px;">CavinHuangのBlog</a>！</span></div></div><div class=article-pagenate><div class="article-prev fl"><span>←</span><a href="/svn常用命令/">svn常用命令</a></div><div class="article-next fr"><a href="/一步一步完成一个node-cli/">一步一步完成一个node-cli</a><span>→</span></div></div></article></div><footer class=footer><div id=toTop style="display: none;">Back to Top</div></footer></div></div><canvas class=fireworks></canvas><script src=/js/velocity.ui.min.js></script><script src=/js/yoyo.js></script><script src=/js/scroll.js></script><script src=/js/particle.js></script><script src=/js/anime.min.js></script><script src=/js/fireworks.js></script>